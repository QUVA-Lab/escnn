<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>escnn.nn &mdash; escnn 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script>window.MathJax = {"TeX": {"Macros": {"bold": ["{\\bf #1}", 1], "R": "{\\mathbb R}", "N": "{\\mathbb N}", "Z": "{\\mathbb Z}", "Ind": ["{\\operatorname{Ind}_{#1}^{#2}}", 2], "Res": ["{\\operatorname{Res}_{#1}^{#2}}", 2], "GL": ["{\\operatorname{GL}(#1)}", 1], "E": ["{\\operatorname{E}(#1)}", 1], "SE": ["{\\operatorname{SE}(#1)}", 1], "O": ["{\\operatorname{O}(#1)}", 1], "SO": ["{\\operatorname{SO}(#1)}", 1], "U": ["{\\operatorname{U}(#1)}", 1], "D": ["{\\operatorname{D}_{#1}}", 1], "C": ["{\\operatorname{C}_{#1}}", 1], "DN": "{\\operatorname{D}_{\\!N}}", "CN": "{\\operatorname{C}_{\\!N}}"}}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Other modules" href="escnn.nn.others.html" />
    <link rel="prev" title="escnn.gspaces" href="escnn.gspaces.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> escnn
          </a>
              <div class="version">
                0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="escnn.group.html">escnn.group</a><ul>
<li class="toctree-l2"><a class="reference internal" href="escnn.group.html#factory-functions">Factory Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.group.html#group">Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.group.html#groupelement">GroupElement</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.group.html#groups">Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.group.html#homogeneous-space">Homogeneous Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.group.html#representations">Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.group.html#utility-functions">Utility Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.group.html#subpackages">Subpackages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="escnn.kernels.html">escnn.kernels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="escnn.kernels.html#abstract-classes">Abstract Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.kernels.html#kernel-bases">Kernel Bases</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.kernels.html#general-wigner-eckart-solvers-for-pairs-of-irreps">General Wigner-Eckart Solvers for pairs of Irreps</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.kernels.html#generic-group-acting-on-a-single-point">Generic Group acting on a single point</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.kernels.html#bases-for-group-actions-on-the-plane">Bases for Group Actions on the Plane</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.kernels.html#bases-for-group-actions-in-3d-space">Bases for Group Actions in 3D Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.kernels.html#space-isomorphisms">Space Isomorphisms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="escnn.gspaces.html">escnn.gspaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="escnn.gspaces.html#factory-methods">Factory Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.gspaces.html#abstract-group-space">Abstract Group Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.gspaces.html#group-action-trivial-on-single-point">Group Action (trivial) on single point</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.gspaces.html#group-actions-on-the-plane">Group Actions on the Plane</a></li>
<li class="toctree-l2"><a class="reference internal" href="escnn.gspaces.html#group-actions-on-the-3d-space">Group Actions on the 3D Space</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">escnn.nn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#field-type">Field Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="#geometric-tensor">Geometric Tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#equivariant-module">Equivariant Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utils">Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linear-layers">Linear Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#steerable-dense-convolution">Steerable Dense Convolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#steerable-point-convolution">Steerable Point Convolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basismanager">BasisManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="#non-linearities">Non Linearities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#invariant-maps">Invariant Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pooling">Pooling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#normalization">Normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dropout">Dropout</a></li>
<li class="toctree-l2"><a class="reference internal" href="#other-modules">Other Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-escnn.nn.init">Weight Initialization</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">escnn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>escnn.nn</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/escnn.nn.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="module-escnn.nn"></span><section id="escnn-nn">
<h1>escnn.nn<a class="headerlink" href="#escnn-nn" title="Permalink to this headline"></a></h1>
<p>This subpackage provides implementations of equivariant neural network modules.</p>
<p>In an equivariant network, features are associated with a transformation law under actions of a symmetry group.
The transformation law of a feature field is implemented by its <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> which can be interpreted as a data type.
A <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> is wrapping a <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> to endow it with a <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a>.
Geometric tensors are processed by <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> s which are <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a> s that guarantee the
specified behavior of their output fields given a transformation of their input fields.</p>
<p>This subpackage depends on <a class="reference internal" href="escnn.group.html"><span class="doc">escnn.group</span></a> and <a class="reference internal" href="escnn.gspaces.html"><span class="doc">escnn.gspaces</span></a>.</p>
<p>To enable efficient deployment of equivariant networks, many <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> s implement a
<a class="reference internal" href="#escnn.nn.EquivariantModule.export" title="escnn.nn.EquivariantModule.export"><code class="xref py py-meth docutils literal notranslate"><span class="pre">export()</span></code></a> method which converts a <em>trained</em> equivariant module into a pure PyTorch
module, with few or no dependencies with <strong>escnn</strong>.
Not all modules support this feature yet, so read each module’s documentation to check whether it implements this method
or not.
We provide a simple example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># build a simple equivariant model using a SequentialModule</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">gspaces</span><span class="o">.</span><span class="n">rot2dOnR2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">trivial_repr</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c_hid</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">regular_repr</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c_out</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">regular_repr</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">SequentialModule</span><span class="p">(</span>
    <span class="n">R2Conv</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">c_hid</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">InnerBatchNorm</span><span class="p">(</span><span class="n">c_hid</span><span class="p">),</span>
    <span class="n">ReLU</span><span class="p">(</span><span class="n">c_hid</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">PointwiseMaxPool</span><span class="p">(</span><span class="n">c_hid</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">R2Conv</span><span class="p">(</span><span class="n">c_hid</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">InnerBatchNorm</span><span class="p">(</span><span class="n">c_out</span><span class="p">),</span>
    <span class="n">ELU</span><span class="p">(</span><span class="n">c_out</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">GroupPooling</span><span class="p">(</span><span class="n">c_out</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># train the model</span>
<span class="c1"># ...</span>

<span class="c1"># export the model</span>

<span class="n">net</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">net_exported</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">export</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">SequentialModule</span><span class="p">(</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="n">R2Conv</span><span class="p">([</span><span class="mi">8</span><span class="o">-</span><span class="n">Rotations</span><span class="p">:</span> <span class="p">{</span><span class="n">irrep_0</span><span class="p">,</span> <span class="n">irrep_0</span><span class="p">,</span> <span class="n">irrep_0</span><span class="p">}],</span> <span class="p">[</span><span class="mi">8</span><span class="o">-</span><span class="n">Rotations</span><span class="p">:</span> <span class="p">{</span><span class="n">regular</span><span class="p">,</span> <span class="n">regular</span><span class="p">,</span> <span class="n">regular</span><span class="p">}],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">InnerBatchNorm</span><span class="p">([</span><span class="mi">8</span><span class="o">-</span><span class="n">Rotations</span><span class="p">:</span> <span class="p">{</span><span class="n">regular</span><span class="p">,</span> <span class="n">regular</span><span class="p">,</span> <span class="n">regular</span><span class="p">}],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_running_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="o">-</span><span class="n">Rotations</span><span class="p">:</span> <span class="p">{</span><span class="n">regular</span><span class="p">,</span> <span class="n">regular</span><span class="p">,</span> <span class="n">regular</span><span class="p">}])</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">PointwiseMaxPool</span><span class="p">()</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">R2Conv</span><span class="p">([</span><span class="mi">8</span><span class="o">-</span><span class="n">Rotations</span><span class="p">:</span> <span class="p">{</span><span class="n">regular</span><span class="p">,</span> <span class="n">regular</span><span class="p">,</span> <span class="n">regular</span><span class="p">}],</span> <span class="p">[</span><span class="mi">8</span><span class="o">-</span><span class="n">Rotations</span><span class="p">:</span> <span class="p">{</span><span class="n">regular</span><span class="p">}],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="n">InnerBatchNorm</span><span class="p">([</span><span class="mi">8</span><span class="o">-</span><span class="n">Rotations</span><span class="p">:</span> <span class="p">{</span><span class="n">regular</span><span class="p">}],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_running_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">6</span><span class="p">):</span> <span class="n">ELU</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="o">-</span><span class="n">Rotations</span><span class="p">:</span> <span class="p">{</span><span class="n">regular</span><span class="p">}])</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">7</span><span class="p">):</span> <span class="n">GroupPooling</span><span class="p">([</span><span class="mi">8</span><span class="o">-</span><span class="n">Rotations</span><span class="p">:</span> <span class="p">{</span><span class="n">regular</span><span class="p">}])</span>
<span class="o">&gt;</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">net_exported</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">Sequential</span><span class="p">(</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">BatchNorm2d</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_running_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="n">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">MaxPool2d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dilation</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ceil_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">Conv2d</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="n">BatchNorm2d</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_running_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">6</span><span class="p">):</span> <span class="n">ELU</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;</span>   <span class="p">(</span><span class="mi">7</span><span class="p">):</span> <span class="n">MaxPoolChannels</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="p">)</span>


<span class="c1"># check that the two models are equivalent</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">c_in</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">GeometricTensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c_in</span><span class="p">)</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">tensor</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">net_exported</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">tensor</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="contents local topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#field-type" id="id13">Field Type</a></p></li>
<li><p><a class="reference internal" href="#geometric-tensor" id="id14">Geometric Tensor</a></p></li>
<li><p><a class="reference internal" href="#equivariant-module" id="id15">Equivariant Module</a></p></li>
<li><p><a class="reference internal" href="#utils" id="id16">Utils</a></p>
<ul>
<li><p><a class="reference internal" href="#direct-sum" id="id17">direct sum</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#linear-layers" id="id18">Linear Layers</a></p>
<ul>
<li><p><a class="reference internal" href="#linear" id="id19">Linear</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#steerable-dense-convolution" id="id20">Steerable Dense Convolution</a></p>
<ul>
<li><p><a class="reference internal" href="#r2conv" id="id21">R2Conv</a></p></li>
<li><p><a class="reference internal" href="#r3conv" id="id22">R3Conv</a></p></li>
<li><p><a class="reference internal" href="#r3icoconv" id="id23">R3IcoConv</a></p></li>
<li><p><a class="reference internal" href="#r2convtransposed" id="id24">R2ConvTransposed</a></p></li>
<li><p><a class="reference internal" href="#r3convtransposed" id="id25">R3ConvTransposed</a></p></li>
<li><p><a class="reference internal" href="#r3icoconvtransposed" id="id26">R3IcoConvTransposed</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#steerable-point-convolution" id="id27">Steerable Point Convolution</a></p>
<ul>
<li><p><a class="reference internal" href="#r2pointconv" id="id28">R2PointConv</a></p></li>
<li><p><a class="reference internal" href="#r3pointconv" id="id29">R3PointConv</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#basismanager" id="id30">BasisManager</a></p></li>
<li><p><a class="reference internal" href="#non-linearities" id="id31">Non Linearities</a></p>
<ul>
<li><p><a class="reference internal" href="#pointwisenonlinearity" id="id32">PointwiseNonLinearity</a></p></li>
<li><p><a class="reference internal" href="#relu" id="id33">ReLU</a></p></li>
<li><p><a class="reference internal" href="#elu" id="id34">ELU</a></p></li>
<li><p><a class="reference internal" href="#fourierpointwise" id="id35">FourierPointwise</a></p></li>
<li><p><a class="reference internal" href="#fourierelu" id="id36">FourierELU</a></p></li>
<li><p><a class="reference internal" href="#quotientfourierpointwise" id="id37">QuotientFourierPointwise</a></p></li>
<li><p><a class="reference internal" href="#quotientfourierelu" id="id38">QuotientFourierELU</a></p></li>
<li><p><a class="reference internal" href="#gatednonlinearity1" id="id39">GatedNonLinearity1</a></p></li>
<li><p><a class="reference internal" href="#gatednonlinearity2" id="id40">GatedNonLinearity2</a></p></li>
<li><p><a class="reference internal" href="#inducedgatednonlinearity1" id="id41">InducedGatedNonLinearity1</a></p></li>
<li><p><a class="reference internal" href="#concatenatednonlinearity" id="id42">ConcatenatedNonLinearity</a></p></li>
<li><p><a class="reference internal" href="#normnonlinearity" id="id43">NormNonLinearity</a></p></li>
<li><p><a class="reference internal" href="#inducednormnonlinearity" id="id44">InducedNormNonLinearity</a></p></li>
<li><p><a class="reference internal" href="#vectorfieldnonlinearity" id="id45">VectorFieldNonLinearity</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#invariant-maps" id="id46">Invariant Maps</a></p>
<ul>
<li><p><a class="reference internal" href="#grouppooling" id="id47">GroupPooling</a></p></li>
<li><p><a class="reference internal" href="#normpool" id="id48">NormPool</a></p></li>
<li><p><a class="reference internal" href="#inducednormpool" id="id49">InducedNormPool</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#pooling" id="id50">Pooling</a></p>
<ul>
<li><p><a class="reference internal" href="#normmaxpool" id="id51">NormMaxPool</a></p></li>
<li><p><a class="reference internal" href="#pointwisemaxpool" id="id52">PointwiseMaxPool</a></p></li>
<li><p><a class="reference internal" href="#pointwisemaxpoolantialiased" id="id53">PointwiseMaxPoolAntialiased</a></p></li>
<li><p><a class="reference internal" href="#pointwiseavgpool" id="id54">PointwiseAvgPool</a></p></li>
<li><p><a class="reference internal" href="#pointwiseavgpoolantialiased" id="id55">PointwiseAvgPoolAntialiased</a></p></li>
<li><p><a class="reference internal" href="#pointwiseavgpool3d" id="id56">PointwiseAvgPool3D</a></p></li>
<li><p><a class="reference internal" href="#pointwiseavgpoolantialiased3d" id="id57">PointwiseAvgPoolAntialiased3D</a></p></li>
<li><p><a class="reference internal" href="#pointwiseadaptiveavgpool" id="id58">PointwiseAdaptiveAvgPool</a></p></li>
<li><p><a class="reference internal" href="#pointwiseadaptivemaxpool" id="id59">PointwiseAdaptiveMaxPool</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#normalization" id="id60">Normalization</a></p>
<ul>
<li><p><a class="reference internal" href="#iidbatchnorm1d" id="id61">IIDBatchNorm1d</a></p></li>
<li><p><a class="reference internal" href="#iidbatchnorm2d" id="id62">IIDBatchNorm2d</a></p></li>
<li><p><a class="reference internal" href="#iidbatchnorm3d" id="id63">IIDBatchNorm3d</a></p></li>
<li><p><a class="reference internal" href="#innerbatchnorm" id="id64">InnerBatchNorm</a></p></li>
<li><p><a class="reference internal" href="#normbatchnorm" id="id65">NormBatchNorm</a></p></li>
<li><p><a class="reference internal" href="#inducednormbatchnorm" id="id66">InducedNormBatchNorm</a></p></li>
<li><p><a class="reference internal" href="#gnormbatchnorm" id="id67">GNormBatchNorm</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dropout" id="id68">Dropout</a></p>
<ul>
<li><p><a class="reference internal" href="#fielddropout" id="id69">FieldDropout</a></p></li>
<li><p><a class="reference internal" href="#pointwisedropout" id="id70">PointwiseDropout</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#other-modules" id="id71">Other Modules</a></p>
<ul>
<li><p><a class="reference internal" href="#sequential" id="id72">Sequential</a></p></li>
<li><p><a class="reference internal" href="#restriction" id="id73">Restriction</a></p></li>
<li><p><a class="reference internal" href="#disentangle" id="id74">Disentangle</a></p></li>
<li><p><a class="reference internal" href="#upsampling" id="id75">Upsampling</a></p></li>
<li><p><a class="reference internal" href="#multiple" id="id76">Multiple</a></p></li>
<li><p><a class="reference internal" href="#reshuffle" id="id77">Reshuffle</a></p></li>
<li><p><a class="reference internal" href="#mask" id="id78">Mask</a></p></li>
<li><p><a class="reference internal" href="#identity" id="id79">Identity</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-escnn.nn.init" id="id80">Weight Initialization</a></p></li>
</ul>
</div>
<section id="field-type">
<h2><a class="toc-backref" href="#contents">Field Type</a><a class="headerlink" href="#field-type" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.FieldType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FieldType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">representations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType" title="Permalink to this definition"></a></dt>
<dd><p>An <code class="docutils literal notranslate"><span class="pre">FieldType</span></code> can be interpreted as the <em>data type</em> of a feature space. It describes:</p>
<ul class="simple">
<li><p>the base space on which a feature field is living and its symmetries considered</p></li>
<li><p>the transformation law of feature fields under the action of the fiber group</p></li>
</ul>
<p>The former is formalize by a choice of <code class="docutils literal notranslate"><span class="pre">gspace</span></code> while the latter is determined by a choice of group
representations (<code class="docutils literal notranslate"><span class="pre">representations</span></code>), passed as a list of <a class="reference internal" href="escnn.group.html#escnn.group.Representation" title="escnn.group.Representation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Representation</span></code></a> instances.
Each single representation in this list corresponds to one independent feature field contained in the feature
space.
The input <code class="docutils literal notranslate"><span class="pre">representations</span></code> need to belong to <code class="docutils literal notranslate"><span class="pre">gspace</span></code>’s fiber group
(<code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.gspaces.GSpace.fibergroup</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mathematically, this class describes a <em>(trivial) vector bundle</em>, <em>associated</em> to the symmetry group
<span class="math notranslate nohighlight">\((\R^D, +) \rtimes G\)</span>.</p>
<p>Given a <em>principal bundle</em> <span class="math notranslate nohighlight">\(\pi: (\R^D, +) \rtimes G \to \R^D, tg \mapsto tG\)</span>
with fiber group <span class="math notranslate nohighlight">\(G\)</span>, an <em>associated vector bundle</em> has the same base space
<span class="math notranslate nohighlight">\(\R^D\)</span> but its fibers are vector spaces like <span class="math notranslate nohighlight">\(\mathbb{R}^c\)</span>.
Moreover, these vector spaces are associated to a <span class="math notranslate nohighlight">\(c\)</span>-dimensional representation <span class="math notranslate nohighlight">\(\rho\)</span> of the
fiber group <span class="math notranslate nohighlight">\(G\)</span> and transform accordingly.</p>
<p>The representation <span class="math notranslate nohighlight">\(\rho\)</span> is defined as the <em>direct sum</em> of the representations <span class="math notranslate nohighlight">\(\{\rho_i\}_i\)</span>
in <code class="docutils literal notranslate"><span class="pre">representations</span></code>. See also <a class="reference internal" href="escnn.group.html#escnn.group.directsum" title="escnn.group.directsum"><code class="xref py py-func docutils literal notranslate"><span class="pre">directsum()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gspace</strong> (<a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace" title="escnn.gspaces.GSpace"><em>GSpace</em></a>) – the space where the feature fields live and its symmetries</p></li>
<li><p><strong>representations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a list of <a class="reference internal" href="escnn.group.html#escnn.group.Representation" title="escnn.group.Representation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Representation</span></code></a> s of the <code class="docutils literal notranslate"><span class="pre">gspace</span></code>’s fiber group,
determining the transformation laws of the feature fields</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>~.gspace</strong> (<a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace" title="escnn.gspaces.GSpace"><em>GSpace</em></a>) – </p></li>
<li><p><strong>~.representations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>~.size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – dimensionality of the feature space described by the <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a>.
It corresponds to the sum of the dimensionalities of the individual feature fields or
group representations (<code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.group.Representation.size</span></code>).</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.FieldType.fibergroup">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fibergroup</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="escnn.group.html#escnn.group.Group" title="escnn.group.group.Group"><span class="pre">escnn.group.group.Group</span></a></em><a class="headerlink" href="#escnn.nn.FieldType.fibergroup" title="Permalink to this definition"></a></dt>
<dd><p>The fiber group of <code class="xref py py-attr docutils literal notranslate"><span class="pre">gspace</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the fiber group</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.FieldType.representation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">representation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="escnn.group.html#escnn.group.Representation" title="escnn.group.representation.Representation"><span class="pre">escnn.group.representation.Representation</span></a></em><a class="headerlink" href="#escnn.nn.FieldType.representation" title="Permalink to this definition"></a></dt>
<dd><p>The (combined) representations of this field type.
They describe how the feature vectors transform under the fiber group action, that is, how the channels mix.</p>
<p>It is the direct sum (<a class="reference internal" href="escnn.group.html#escnn.group.directsum" title="escnn.group.directsum"><code class="xref py py-func docutils literal notranslate"><span class="pre">directsum()</span></code></a>) of the representations in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code>.</p>
<p>Because a feature space can contain a very large number of feature fields, computing this representation as
the direct sum of many small representations can be expensive.
Hence, this representation is only built the first time it is explicitly used, in order to avoid unnecessary
overhead when not needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the <a class="reference internal" href="escnn.group.html#escnn.group.Representation" title="escnn.group.Representation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Representation</span></code></a> describing the whole feature space</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.FieldType.irreps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">irreps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#escnn.nn.FieldType.irreps" title="Permalink to this definition"></a></dt>
<dd><p>Ordered list of irreps contained in the <a class="reference internal" href="#escnn.nn.FieldType.representation" title="escnn.nn.FieldType.representation"><code class="xref py py-attr docutils literal notranslate"><span class="pre">representation</span></code></a> of the field type.
It is the concatenation of the irreps in each representation in <code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of irreps</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.FieldType.change_of_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_of_basis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span></em><a class="headerlink" href="#escnn.nn.FieldType.change_of_basis" title="Permalink to this definition"></a></dt>
<dd><p>The change of basis matrix which decomposes the field types representation into irreps, given as a sparse
(block diagonal) matrix (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.coo_matrix.html#scipy.sparse.coo_matrix" title="(in SciPy v1.8.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.coo_matrix</span></code></a>).</p>
<p>It is the direct sum of the change of basis matrices of each representation in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.group.Representation.change_of_basis</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the change of basis</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.FieldType.change_of_basis_inv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">change_of_basis_inv</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">scipy.sparse.coo.coo_matrix</span></em><a class="headerlink" href="#escnn.nn.FieldType.change_of_basis_inv" title="Permalink to this definition"></a></dt>
<dd><p>Inverse of the (sparse) change of basis matrix. See <a class="reference internal" href="#escnn.nn.FieldType.change_of_basis" title="escnn.nn.FieldType.change_of_basis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.change_of_basis</span></code></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the inverted change of basis</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.get_dense_change_of_basis">
<span class="sig-name descname"><span class="pre">get_dense_change_of_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.get_dense_change_of_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.get_dense_change_of_basis" title="Permalink to this definition"></a></dt>
<dd><p>The method returns a dense <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> containing a copy of the change-of-basis matrix.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="#escnn.nn.FieldType.change_of_basis" title="escnn.nn.FieldType.change_of_basis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.change_of_basis</span></code></a> for more details.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.get_dense_change_of_basis_inv">
<span class="sig-name descname"><span class="pre">get_dense_change_of_basis_inv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.get_dense_change_of_basis_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.get_dense_change_of_basis_inv" title="Permalink to this definition"></a></dt>
<dd><p>The method returns a dense <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> containing a copy of the inverse of the
change-of-basis matrix.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="#escnn.nn.FieldType.change_of_basis" title="escnn.nn.FieldType.change_of_basis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.change_of_basis</span></code></a> for more details.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.fiber_representation">
<span class="sig-name descname"><span class="pre">fiber_representation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.fiber_representation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.fiber_representation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.transform_fibers">
<span class="sig-name descname"><span class="pre">transform_fibers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.transform_fibers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.transform_fibers" title="Permalink to this definition"></a></dt>
<dd><p>Transform the feature vectors of the input tensor according to the group representation associated to
the input element.</p>
<p>Interpreting the tensor as a vector-valued signal <span class="math notranslate nohighlight">\(f: X \to \mathbb{R}^c\)</span> over a base space <span class="math notranslate nohighlight">\(X\)</span>
(where <span class="math notranslate nohighlight">\(c\)</span> is the number of channels of the tensor), given the input <code class="docutils literal notranslate"><span class="pre">element</span></code> <span class="math notranslate nohighlight">\(g \in G\)</span>
(<span class="math notranslate nohighlight">\(G\)</span> fiber group) the method returns the new signal <span class="math notranslate nohighlight">\(f'\)</span>:</p>
<div class="math notranslate nohighlight">
\[f'(x) := \rho(g) f(x)\]</div>
<p>for <span class="math notranslate nohighlight">\(x \in X\)</span> point in the base space and <span class="math notranslate nohighlight">\(\rho\)</span> the representation of <span class="math notranslate nohighlight">\(G\)</span> in the
field type of this tensor.</p>
<p>Notice that the input element has to be an element of the fiber group of this tensor’s field type.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="#escnn.nn.FieldType.transform" title="escnn.nn.FieldType.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.FieldType.transform()</span></code></a> to transform the whole tensor.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the tensor to transform</p></li>
<li><p><strong>element</strong> (<a class="reference internal" href="escnn.group.html#escnn.group.GroupElement" title="escnn.group.GroupElement"><em>GroupElement</em></a>) – an element of the group of symmetries of the fiber.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the transformed tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.transform" title="Permalink to this definition"></a></dt>
<dd><p>The method takes a PyTorch’s tensor, compatible with this type (i.e. whose spatial dimensions are
supported by the base space and whose number of channels equals the <code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.size</span></code>
of this type), and an element of the fiber group of this type.</p>
<p>Transform the input tensor according to the group representation associated with the input element
and its (induced) action on the base space.</p>
<p>This transformation includes both an action over the basespace (e.g. a rotation of the points on the plane)
and a transformation of the channels by left-multiplying them with a representation of the fiber group.</p>
<p>The method takes as input a tensor (<code class="docutils literal notranslate"><span class="pre">input</span></code>) and an <code class="docutils literal notranslate"><span class="pre">element</span></code> of the fiber
group. The tensor <code class="docutils literal notranslate"><span class="pre">input</span></code> is the feature field to be transformed and needs to be compatible with the G-space
and the representation (i.e. its number of channels equals the size of that representation).
<code class="docutils literal notranslate"><span class="pre">element</span></code> needs to belong to the fiber group: check <code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.group.GroupElement.group()</span></code>.
This method returns a transformed tensor through the action of <code class="docutils literal notranslate"><span class="pre">element</span></code>.</p>
<p>In addition, the method accepts an optional <cite>coords</cite> tensor.
If the argument is not passed, the <cite>input</cite> tensor is assumed to have shape
<cite>(batchsize, channels, *spatial_grid_shape)</cite> and to represent features sampled on a grid of shape
<cite>spatial_grid_shape</cite>; in this case,  the action on the base space resamples the transformed features on this
grid (using interpolation, if necessary).
If <cite>coords</cite> is not <cite>None</cite>, <cite>input</cite> is assumed to be a <cite>(#points, channels)</cite> tensor containing an unstructured
set of points living on the base space; then, <cite>coords</cite> should contain the coordinates of these points.
The base space action will then transform these coordinates (no interpolation required).
In that case, the method returns a pair containing both the transformed features (according to the action on the
fibers) and the transformed coordinates (according to the action on the basespace).</p>
<p>More precisely, given an input tensor, interpreted as an <span class="math notranslate nohighlight">\(c\)</span>-dimensional signal
<span class="math notranslate nohighlight">\(f: \R^D \to \mathbb{R}^c\)</span> defined over the base space <span class="math notranslate nohighlight">\(\R^D\)</span>, a representation
<span class="math notranslate nohighlight">\(\rho: G \to \mathbb{R}^{c \times c}\)</span> of <span class="math notranslate nohighlight">\(G\)</span> and an element <span class="math notranslate nohighlight">\(g \in G\)</span> of the fiber group,
the method returns the transformed signal <span class="math notranslate nohighlight">\(f'\)</span> defined as:</p>
<div class="math notranslate nohighlight">
\[f'(x) := \rho(g) f(g^{-1} x)\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mathematically, this method transforms the input with the <strong>induced representation</strong> from the input <code class="docutils literal notranslate"><span class="pre">repr</span></code>
(<span class="math notranslate nohighlight">\(\rho\)</span>) of the symmetry group (<span class="math notranslate nohighlight">\(G\)</span>) to the <em>total space</em> (<span class="math notranslate nohighlight">\(P\)</span>), i.e.
with <span class="math notranslate nohighlight">\(Ind_{G}^{P} \rho\)</span>.
For more details on this, see
<a class="reference external" href="https://arxiv.org/abs/1911.08251">General E(2)-Equivariant Steerable CNNs</a> or
<a class="reference external" href="https://papers.nips.cc/paper/9114-a-general-theory-of-equivariant-cnns-on-homogeneous-spaces.pdf">A General Theory of Equivariant CNNs On Homogeneous Spaces</a>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In case <cite>coords</cite> is not passed and, therefore, the resampling of the grid is performed, the input tensor is
detached before the transformation, therefore no gradient is propagated back through this operation.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="#escnn.nn.GeometricTensor.transform_fibers" title="escnn.nn.GeometricTensor.transform_fibers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.GeometricTensor.transform_fibers()</span></code></a> to transform only the fibers, i.e. not transform
the base space.</p>
<p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.gspaces.GSpace._interpolate_transform_basespace()</span></code> for more details on the action on the
base space.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – input tensor</p></li>
<li><p><strong>element</strong> (<a class="reference internal" href="escnn.group.html#escnn.group.GroupElement" title="escnn.group.GroupElement"><em>GroupElement</em></a>) – element of the fiber group</p></li>
<li><p><strong>coords</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a><em>, </em><em>optional</em>) – coordinates of the points in <cite>input</cite>. If <cite>None</cite> (by default), it assumes
the points <cite>input</cite> are arranged in a grid and it transforms the grid by
interpolation. Otherwise, it transforms the coordinates in <cite>coords</cite> using
<cite>self.gspace.basespace_action()</cite>. In the last case, the method returns a
tuple <cite>(transformed_input, transformed_coords)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>transformed tensor and, optionally, the transformed coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.restrict">
<span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.restrict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.restrict" title="Permalink to this definition"></a></dt>
<dd><p>Reduce the symmetries modeled by the <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> by choosing a subgroup of its fiber group as
specified by <code class="docutils literal notranslate"><span class="pre">id</span></code>. This implies a restriction of each representation in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code> to this subgroup.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Check the documentation of the <a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace.restrict" title="escnn.gspaces.GSpace.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">restrict()</span></code></a> method in the subclass of
<a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace" title="escnn.gspaces.GSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">GSpace</span></code></a> used for a description of the parameter <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> – identifier of the subgroup to which the <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> and its
<code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code> should be restricted</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the restricted type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.sorted">
<span class="sig-name descname"><span class="pre">sorted</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.sorted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.sorted" title="Permalink to this definition"></a></dt>
<dd><p>Return a new field type containing the fields of the current one sorted by their dimensionalities.
It is built from the <code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code> of this field type sorted.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the sorted field type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.__add__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.__add__" title="Permalink to this definition"></a></dt>
<dd><p>Returns a field type associate with the <em>direct sum</em> <span class="math notranslate nohighlight">\(\rho = \rho_1 \oplus \rho_2\)</span> of the representations
<span class="math notranslate nohighlight">\(\rho_1\)</span> and <span class="math notranslate nohighlight">\(\rho_2\)</span> of two field types.</p>
<p>In practice, the method builds a new <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> using the concatenation of the lists
<code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code> of the two field types.</p>
<p>The two field types need to be associated with the same <a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace" title="escnn.gspaces.GSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">GSpace</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the other addend</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the direct sum</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.__len__" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of feature fields in this <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a>, i.e. the length of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is in general different from <code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.size</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of fields in this type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.fields_names">
<span class="sig-name descname"><span class="pre">fields_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.fields_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.fields_names" title="Permalink to this definition"></a></dt>
<dd><p>Return an ordered list containing the names of the representation associated with each field.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of fields’ representations’ names</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.index_select">
<span class="sig-name descname"><span class="pre">index_select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.index_select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.index_select" title="Permalink to this definition"></a></dt>
<dd><p>Build a new <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> from the current one by taking the
<a class="reference internal" href="escnn.group.html#escnn.group.Representation" title="escnn.group.Representation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Representation</span></code></a> s selected by the input <code class="docutils literal notranslate"><span class="pre">index</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a list of integers in the range <code class="docutils literal notranslate"><span class="pre">{0,</span> <span class="pre">...,</span> <span class="pre">N-1}</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of representations
in the current field type</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the new field type</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.FieldType.fields_end">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fields_end</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a></em><a class="headerlink" href="#escnn.nn.FieldType.fields_end" title="Permalink to this definition"></a></dt>
<dd><p>Array containing the index of the first channel following each field.
More precisely, the integer in the <span class="math notranslate nohighlight">\(i\)</span>-th position is equal to the index of the last channel of
the <span class="math notranslate nohighlight">\(i\)</span>-th field plus <span class="math notranslate nohighlight">\(1\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.FieldType.fields_start">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fields_start</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a></em><a class="headerlink" href="#escnn.nn.FieldType.fields_start" title="Permalink to this definition"></a></dt>
<dd><p>Array containing the index of the first channel of each field.
More precisely, the integer in the <span class="math notranslate nohighlight">\(i\)</span>-th position is equal to the index of the first channel of
the <span class="math notranslate nohighlight">\(i\)</span>-th field.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.group_by_labels">
<span class="sig-name descname"><span class="pre">group_by_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.group_by_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.group_by_labels" title="Permalink to this definition"></a></dt>
<dd><p>Associate a label to each feature field (or representation in <code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code>)
and group them accordingly into new <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a list of strings with length equal to the number of representations in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dictionary mapping each different input label to a new field type</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.FieldType.uniform">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uniform</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#escnn.nn.FieldType.uniform" title="Permalink to this definition"></a></dt>
<dd><p>Whether this FieldType contains only copies of the same representation, i.e. if all the elements of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">representations</span></code> are the same <a class="reference internal" href="escnn.group.html#escnn.group.Representation" title="escnn.group.Representation"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.group.Representation</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldType.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/field_type.html#FieldType.__iter__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldType.__iter__" title="Permalink to this definition"></a></dt>
<dd><p>It is possible to iterate over all <code class="xref py py-attr docutils literal notranslate"><span class="pre">representations</span></code> in a field type by using
<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> as an <em>iterable</em> object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.FieldType.testing_elements">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">testing_elements</span></span><a class="headerlink" href="#escnn.nn.FieldType.testing_elements" title="Permalink to this definition"></a></dt>
<dd><p>Alias for <code class="docutils literal notranslate"><span class="pre">self.gspace.testing_elements</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace.testing_elements" title="escnn.gspaces.GSpace.testing_elements"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.gspaces.GSpace.testing_elements</span></code></a> and
<a class="reference internal" href="escnn.group.html#escnn.group.Group.testing_elements" title="escnn.group.Group.testing_elements"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.group.Group.testing_elements</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="geometric-tensor">
<h2><a class="toc-backref" href="#contents">Geometric Tensor</a><a class="headerlink" href="#geometric-tensor" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GeometricTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor" title="Permalink to this definition"></a></dt>
<dd><p>A GeometricTensor can be interpreted as a <em>typed</em> tensor.
It is wrapping a common <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> and endows it with a (compatible) <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> as
<em>transformation law</em>.</p>
<p>The <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> describes the action of a group <span class="math notranslate nohighlight">\(G\)</span> on the tensor.
This action includes both a transformation of the base space and a transformation of the channels according to
a <span class="math notranslate nohighlight">\(G\)</span>-representation <span class="math notranslate nohighlight">\(\rho\)</span>.</p>
<p>All <em>escnn</em> neural network operations have <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> s as inputs and outputs.
They perform a dynamic typechecking, ensuring that the transformation laws of the data and the operation match.
See also <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a>.</p>
<p>As usual, the first dimension of the tensor is interpreted as the batch dimension. The second is the fiber
(or channel) dimension, which is associated with a group representation by the field type. The following
dimensions are the spatial dimensions (like in a conventional CNN).</p>
<p>In addition, the method accepts an optional <cite>coords</cite> tensor.
If the argument is not passed, the <cite>input</cite> tensor is assumed to have shape
<cite>(batchsize, channels, *spatial_grid_shape)</cite> and to represent features sampled on a grid of shape
<cite>spatial_grid_shape</cite>; in this case,  the action on the base space resamples the transformed features on this
grid (using interpolation, if necessary).
If <cite>coords</cite> is not <cite>None</cite>, <cite>input</cite> is assumed to be a <cite>(#points, channels)</cite> tensor containing an unstructured
set of points living on the base space; then, <cite>coords</cite> should contain the coordinates of these points.
The base space action will then transform these coordinates (no interpolation required).
In that case, the method returns a pair containing both the transformed features (according to the action on the
fibers) and the transformed coordinates (according to the action on the basespace).</p>
<p>In addition, this class accepts an optional argument <cite>coords</cite>.
If the argument is not passed, the input <cite>tensor</cite> is assumed to have shape
<cite>(batchsize, channels, *spatial_grid_shape)</cite> and to represent features sampled on a grid of shape
<cite>spatial_grid_shape</cite>; in this case,  the action on the base space resamples the transformed features on this
grid (using interpolation, if necessary).
If <cite>coords</cite> is not <cite>None</cite>, <cite>tensor</cite> is assumed to be a <cite>(#points, channels)</cite> tensor containing an unstructured
set of points living on the base space; then, <cite>coords</cite> should contain the coordinates of these points.
The tensor <cite>coords</cite> must have shape <cite>(#points, type.gspace.dimensionality)</cite>, where <cite>#points = tensor.shape[0]</cite>.
The base space action will then transform these coordinates (no interpolation required).
See also the method <a class="reference internal" href="#escnn.nn.FieldType.transform" title="escnn.nn.FieldType.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.FieldType.transform()</span></code></a> for more details.</p>
<p>The operations of <strong>addition</strong> and <strong>scalar multiplication</strong> are supported.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">gspaces</span><span class="o">.</span><span class="n">rot2dOnR2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="nb">type</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="p">[</span><span class="n">gs</span><span class="o">.</span><span class="n">regular_repr</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">GeometricTensor</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">type</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">GeometricTensor</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">type</span><span class="p">)</span>

<span class="c1"># addition</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">+</span> <span class="n">t2</span>

<span class="c1"># scalar product</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="mf">3.</span>

<span class="c1"># scalar product also supports tensors containing only one scalar</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">3.</span><span class="p">)</span>

<span class="c1"># inplace operations are also supported</span>
<span class="n">t1</span> <span class="o">+=</span> <span class="n">t2</span>
<span class="n">t2</span> <span class="o">*=</span> <span class="mf">3.</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The multiplication of a PyTorch tensor containing only a scalar with a GeometricTensor is only supported
when using PyTorch 1.4 or higher (see this <a class="reference external" href="https://github.com/pytorch/pytorch/issues/26333">issue</a> )</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These operations are only supported for <em>compatible</em> tensors, i.e. tensors which share the same <cite>type</cite> and,
if set, <cite>coords</cite>.</p>
</div>
<p>A GeometricTensor can also be right-multiplied with a <a class="reference internal" href="escnn.group.html#escnn.group.GroupElement" title="escnn.group.GroupElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">GroupElement</span></code></a> with the <cite>&#64;</cite> operator.
The group element must belong to the <a class="reference internal" href="#escnn.nn.FieldType.fibergroup" title="escnn.nn.FieldType.fibergroup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">fibergroup</span></code></a> of the <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a>
<cite>type</cite> of this tensor.
The right-multiplication through <cite>&#64;</cite> <em>only transforms the channels</em> using the group representation
<cite>type.representation</cite> but <em>does not transform the base space</em>.
This operation is equivalent to <a class="reference internal" href="#escnn.nn.GeometricTensor.transform_fibers" title="escnn.nn.GeometricTensor.transform_fibers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform_fibers()</span></code></a>.
Check its documentation for more details.</p>
<p>A GeometricTensor supports <strong>slicing</strong> in a similar way to PyTorch’s <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>.
More precisely, slicing along the batch (1st) and the spatial (3rd, 4th, …) dimensions works as usual.
However, slicing the fiber (2nd) dimension would break equivariance when splitting channels belonging to
the same field.
To prevent this, slicing on the second dimension is defined over <em>fields</em> instead of channels.
Note that, if <cite>coords</cite> is not <cite>None</cite>, slicing over the first dimension also slices the <cite>coords</cite> tensor over its
first dimension.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>GeometricTensor only supports basic <em>slicing</em> but it does <strong>not</strong> support <em>advanced indexing</em> (see NumPy’s
documentation about
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#basic-slicing-and-indexing">indexing</a>
for more details).
Moreover, in contrast to NumPy and PyTorch, an index containing a single integer value <strong>does not</strong> reduce
the dimensionality of the tensor.
In this way, the resulting tensor can always be interpreted as a GeometricTensor.</p>
</div>
<p>We give few examples to illustrate this behavior:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of GeometricTensor slicing</span>
<span class="n">space</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">gspaces</span><span class="o">.</span><span class="n">rot2dOnR2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">type</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="p">[</span>
    <span class="c1"># field type            # index # size</span>
    <span class="n">space</span><span class="o">.</span><span class="n">regular_repr</span><span class="p">,</span>     <span class="c1">#   0   #  4</span>
    <span class="n">space</span><span class="o">.</span><span class="n">regular_repr</span><span class="p">,</span>     <span class="c1">#   1   #  4</span>
    <span class="n">space</span><span class="o">.</span><span class="n">irrep</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>         <span class="c1">#   2   #  2</span>
    <span class="n">space</span><span class="o">.</span><span class="n">irrep</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>         <span class="c1">#   3   #  2</span>
    <span class="n">space</span><span class="o">.</span><span class="n">trivial_repr</span><span class="p">,</span>     <span class="c1">#   4   #  1</span>
    <span class="n">space</span><span class="o">.</span><span class="n">trivial_repr</span><span class="p">,</span>     <span class="c1">#   5   #  1</span>
    <span class="n">space</span><span class="o">.</span><span class="n">trivial_repr</span><span class="p">,</span>     <span class="c1">#   6   #  1</span>
<span class="p">])</span>                          <span class="c1">#   sum = 15</span>

<span class="c1"># this FieldType contains 8 fields</span>
<span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="mi">7</span>

<span class="c1"># the size of this FieldType is equal to the sum of the sizes of each of its fields</span>
<span class="nb">type</span><span class="o">.</span><span class="n">size</span>
<span class="o">&gt;&gt;</span> <span class="mi">15</span>

<span class="n">geom_tensor</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">GeometricTensor</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">type</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="nb">type</span><span class="p">)</span>

<span class="n">geom_tensor</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>

<span class="n">geom_tensor</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">geom_tensor</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># the tensor contains the fields 1:4, i.e 1, 2 and 3</span>
<span class="c1"># these fields have size, respectively, 4, 2 and 2</span>
<span class="c1"># so the resulting tensor has 8 channels</span>
<span class="n">geom_tensor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>

<span class="c1"># the tensor contains the fields 0:6:2, i.e 0, 2 and 4</span>
<span class="c1"># these fields have size, respectively, 4, 2 and 1</span>
<span class="c1"># so the resulting tensor has 7 channels</span>
<span class="n">geom_tensor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>

<span class="c1"># the tensor contains only the field 2, which has size 2</span>
<span class="c1"># note, also, that even though a single index is used for the batch dimension, the resulting tensor</span>
<span class="c1"># still has 4 dimensions</span>
<span class="n">geom_tensor</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>Slicing</em> over the fiber (2nd) dimension with <code class="docutils literal notranslate"><span class="pre">step</span> <span class="pre">&gt;</span> <span class="pre">1</span></code> or with a negative step is converted
into <em>indexing</em> over the channels.
This means that, in these cases, slicing behaves like <em>advanced indexing</em> in PyTorch and NumPy
<strong>returning a copy instead of a view</strong>.
For more details, see the <em>note</em> <a class="reference external" href="https://pytorch.org/docs/stable/tensor_view.html">here</a> and
<em>NumPy</em>’s <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">docs</a> .</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Slicing is not supported for setting values inside the tensor
(i.e. <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__setitem__" title="(in Python v3.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setitem__()</span></code></a> is not implemented).
Indeed, depending on the values which are assigned, this operation can break the symmetry of the tensor
which may not transform anymore according to its transformation law (specified by <code class="docutils literal notranslate"><span class="pre">type</span></code>).
In case this feature is necessary, one can directly access the underlying <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>, e.g.
<code class="docutils literal notranslate"><span class="pre">geom_tensor.tensor[:3,</span> <span class="pre">:,</span> <span class="pre">2:5,</span> <span class="pre">2:5]</span> <span class="pre">=</span> <span class="pre">torch.randn(3,</span> <span class="pre">4,</span> <span class="pre">3,</span> <span class="pre">3)</span></code>, although this is not recommended.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the tensor data</p></li>
<li><p><strong>type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the tensor, modeling its transformation law</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>~.tensor</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – </p></li>
<li><p><strong>~.type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.restrict">
<span class="sig-name descname"><span class="pre">restrict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.restrict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.restrict" title="Permalink to this definition"></a></dt>
<dd><p>Restrict the field type of this tensor.</p>
<p>The method returns a new <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> whose <code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code>
is equal to this tensor’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code>
restricted to a subgroup <span class="math notranslate nohighlight">\(H&lt;G\)</span> (see <a class="reference internal" href="#escnn.nn.FieldType.restrict" title="escnn.nn.FieldType.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.FieldType.restrict()</span></code></a>).
The restricted <code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code> is associated with the restricted representation
<span class="math notranslate nohighlight">\(\Res{H}{G}\rho\)</span> of the <span class="math notranslate nohighlight">\(G\)</span>-representation <span class="math notranslate nohighlight">\(\rho\)</span> associated to this tensor’s
<code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code>.
The input <code class="docutils literal notranslate"><span class="pre">id</span></code> specifies the subgroup <span class="math notranslate nohighlight">\(H &lt; G\)</span>.</p>
<p>Notice that the underlying <code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor</span></code> instance will be shared between
the current tensor and the returned one.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The method builds the new representation on the fly; hence, if this operation is needed at run time,
we suggest to use <a class="reference internal" href="#escnn.nn.RestrictionModule" title="escnn.nn.RestrictionModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.RestrictionModule</span></code></a> which pre-computes the new representation offline.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Check the documentation of the <a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace.restrict" title="escnn.gspaces.GSpace.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">restrict()</span></code></a> method in the
<a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace" title="escnn.gspaces.GSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">GSpace</span></code></a> instance used for a description of the parameter <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> – the id identifying the subgroup <span class="math notranslate nohighlight">\(H\)</span> the representations are restricted to</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the geometric tensor with the restricted representations</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">breaks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.split" title="Permalink to this definition"></a></dt>
<dd><p>Split this tensor on the channel dimension in a list of smaller tensors.
The original tensor is split at the <em>fields</em> specified by the index list <code class="docutils literal notranslate"><span class="pre">breaks</span></code>.</p>
<p>If the tensor is associated with the list of fields <span class="math notranslate nohighlight">\(\{\rho_i\}_i\)</span>
(see <code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.representations</span></code>), the <span class="math notranslate nohighlight">\(j\)</span>-th output tensor will contain the fields
<span class="math notranslate nohighlight">\(\rho_{\text{breaks}[j-1]}, \dots, \rho_{\text{breaks}[j]-1}\)</span> of the original tensor.</p>
<p>If <cite>breaks = None</cite>, the tensor is split at each field.
This is equivalent to using <cite>breaks = list(range(len(self.type)))</cite>.</p>
<p>Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">space</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">gspaces</span><span class="o">.</span><span class="n">rot2dOnR2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">type</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="p">[</span>
    <span class="n">space</span><span class="o">.</span><span class="n">regular_repr</span><span class="p">,</span>     <span class="c1"># size = 4</span>
    <span class="n">space</span><span class="o">.</span><span class="n">regular_repr</span><span class="p">,</span>     <span class="c1"># size = 4</span>
    <span class="n">space</span><span class="o">.</span><span class="n">irrep</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>         <span class="c1"># size = 2</span>
    <span class="n">space</span><span class="o">.</span><span class="n">irrep</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>         <span class="c1"># size = 2</span>
    <span class="n">space</span><span class="o">.</span><span class="n">trivial_repr</span><span class="p">,</span>     <span class="c1"># size = 1</span>
    <span class="n">space</span><span class="o">.</span><span class="n">trivial_repr</span><span class="p">,</span>     <span class="c1"># size = 1</span>
    <span class="n">space</span><span class="o">.</span><span class="n">trivial_repr</span><span class="p">,</span>     <span class="c1"># size = 1</span>
<span class="p">])</span>                          <span class="c1">#  sum = 15</span>

<span class="nb">type</span><span class="o">.</span><span class="n">size</span>
<span class="o">&gt;&gt;</span> <span class="mi">15</span>

<span class="n">geom_tensor</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">GeometricTensor</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">type</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="nb">type</span><span class="p">)</span>

<span class="n">geom_tensor</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="c1"># split the tensor in 3 parts</span>
<span class="nb">len</span><span class="p">(</span><span class="n">geom_tensor</span><span class="o">.</span><span class="n">split</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))</span>
<span class="o">&gt;&gt;</span> <span class="mi">3</span>

<span class="c1"># the first contains</span>
<span class="c1"># - the first 2 regular fields (2*4 = 8 channels)</span>
<span class="c1"># - 2 vector fields (irrep(1)) (2*2 = 4 channels)</span>
<span class="c1"># and, therefore, contains 12 channels</span>
<span class="n">geom_tensor</span><span class="o">.</span><span class="n">split</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="c1"># the second contains only 2 scalar (trivial) fields (2*1 = 2 channels)</span>
<span class="n">geom_tensor</span><span class="o">.</span><span class="n">split</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="c1"># the last contains only 1 scalar (trivial) field (1*1 = 1 channels)</span>
<span class="n">geom_tensor</span><span class="o">.</span><span class="n">split</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="o">&gt;&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>breaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – indices of the fields where to split the tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> s into which the original tensor is chunked</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.transform" title="Permalink to this definition"></a></dt>
<dd><p>Transform the current tensor according to the group representation associated to the input element
and its induced action on the base space</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The input tensor is detached before the transformation therefore no gradient is backpropagated
through this operation</p>
<p>See <a class="reference internal" href="#escnn.nn.GeometricTensor.transform_fibers" title="escnn.nn.GeometricTensor.transform_fibers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.GeometricTensor.transform_fibers()</span></code></a> to transform only the fibers, i.e. not transform
the base space.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>element</strong> (<a class="reference internal" href="escnn.group.html#escnn.group.GroupElement" title="escnn.group.GroupElement"><em>GroupElement</em></a>) – an element of the group of symmetries of the fiber.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the transformed tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.transform_fibers">
<span class="sig-name descname"><span class="pre">transform_fibers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.transform_fibers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.transform_fibers" title="Permalink to this definition"></a></dt>
<dd><p>Transform the feature vectors of the underlying tensor according to the group representation associated to
the input element.</p>
<p>Interpreting the tensor as a vector-valued signal <span class="math notranslate nohighlight">\(f: X \to \mathbb{R}^c\)</span> over a base space <span class="math notranslate nohighlight">\(X\)</span>
(where <span class="math notranslate nohighlight">\(c\)</span> is the number of channels of the tensor), given the input <code class="docutils literal notranslate"><span class="pre">element</span></code> <span class="math notranslate nohighlight">\(g \in G\)</span>
(<span class="math notranslate nohighlight">\(G\)</span> fiber group) the method returns the new signal <span class="math notranslate nohighlight">\(f'\)</span>:</p>
<div class="math notranslate nohighlight">
\[f'(x) := \rho(g) f(x)\]</div>
<p>for <span class="math notranslate nohighlight">\(x \in X\)</span> point in the base space and <span class="math notranslate nohighlight">\(\rho\)</span> the representation of <span class="math notranslate nohighlight">\(G\)</span> in the
field type of this tensor.</p>
<p>Notice that the input element has to be an element of the fiber group of this tensor’s field type.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="#escnn.nn.GeometricTensor.transform" title="escnn.nn.GeometricTensor.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.GeometricTensor.transform()</span></code></a> to transform the whole tensor.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>element</strong> (<a class="reference internal" href="escnn.group.html#escnn.group.GroupElement" title="escnn.group.GroupElement"><em>GroupElement</em></a>) – an element of the group of symmetries of the fiber.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the transformed tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#escnn.nn.GeometricTensor.shape" title="Permalink to this definition"></a></dt>
<dd><p>Alias for <code class="docutils literal notranslate"><span class="pre">self.tensor.shape</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.size" title="Permalink to this definition"></a></dt>
<dd><p>Alias for <code class="docutils literal notranslate"><span class="pre">self.tensor.size()</span></code></p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://pytorch.org/docs/master/generated/torch.Tensor.size.html#torch.Tensor.size" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.size()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.to" title="Permalink to this definition"></a></dt>
<dd><p>Alias for <code class="docutils literal notranslate"><span class="pre">self.tensor.to(*args,</span> <span class="pre">**kwargs)</span></code>.</p>
<p>Applies <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.Tensor.to.html#torch.Tensor.to" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.to()</span></code></a> to the underlying tensor and wraps the resulting tensor in a new
<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> with the same type.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method does not affect <code class="docutils literal notranslate"><span class="pre">self.coords</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.__getitem__" title="Permalink to this definition"></a></dt>
<dd><p>A GeometricTensor supports <em>slicing</em> in a similar way to PyTorch’s <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>.
More precisely, slicing along the batch (1st) and the spatial (3rd, 4th, …) dimensions works as usual.
However, slicing along the channel dimension could break equivariance by splitting the channels belonging to the
same field.
For this reason, slicing on the second dimension is not defined over the channels but over fields.</p>
<p>When a continuous (step=1) slice is used over the fields/channels dimension (the 2nd axis), it is converted
into a continuous slice over the channels.
This is not possible when the step is greater than 1 or negative.
In such cases, the slice over the fields needs to be converted into an index over the channels.</p>
<p>Moreover, when a single integer is used to index an axis, that axis is not discarded as in PyTorch but is
preserved with size 1.</p>
<p>If slicing is performed over the batch dimension and <cite>coords</cite> is not <cite>None</cite>, also the <cite>coords</cite> tensor is sliced.</p>
<p>Slicing is not supported for setting values inside the tensor (i.e. <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__setitem__" title="(in Python v3.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">object.__setitem__()</span></code></a>
is not implemented).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.has_same_coords">
<span class="sig-name descname"><span class="pre">has_same_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.has_same_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.has_same_coords" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.is_compatible">
<span class="sig-name descname"><span class="pre">is_compatible</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.is_compatible"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.is_compatible" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.__add__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.__add__" title="Permalink to this definition"></a></dt>
<dd><p>Add two compatible <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> using pointwise addition.
The two tensors needs to have the same shape and be associated to the same field type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the other geometric tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the sum</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.__sub__">
<span class="sig-name descname"><span class="pre">__sub__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.__sub__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.__sub__" title="Permalink to this definition"></a></dt>
<dd><p>Subtract two compatible <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> using pointwise subtraction.
The two tensors needs to have the same shape and be associated to the same field type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the other geometric tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>their difference</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.__iadd__">
<span class="sig-name descname"><span class="pre">__iadd__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.__iadd__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.__iadd__" title="Permalink to this definition"></a></dt>
<dd><p>Add a compatible <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> to this tensor inplace.
The two tensors needs to have the same shape and be associated to the same field type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the other geometric tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>this tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.__isub__">
<span class="sig-name descname"><span class="pre">__isub__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.__isub__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.__isub__" title="Permalink to this definition"></a></dt>
<dd><p>Subtract a compatible <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> to this tensor inplace.
The two tensors needs to have the same shape and be associated to the same field type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the other geometric tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>this tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.__mul__">
<span class="sig-name descname"><span class="pre">__mul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.__mul__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.__mul__" title="Permalink to this definition"></a></dt>
<dd><p>Scalar product of this <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> with a scalar.</p>
<p>The scalar can be a float number or a <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> containing only
one scalar (i.e. <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.numel.html#torch.numel" title="(in PyTorch v1.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.numel()</span></code></a> should return <cite>1</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]) – a scalar</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the scalar product</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.__rmul__">
<span class="sig-name descname"><span class="pre">__rmul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#escnn.nn.GeometricTensor.__rmul__" title="Permalink to this definition"></a></dt>
<dd><p>Scalar product of this <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> with a scalar.</p>
<p>The scalar can be a float number or a <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> containing only
one scalar (i.e. <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.numel.html#torch.numel" title="(in PyTorch v1.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.numel()</span></code></a> should return <cite>1</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]) – a scalar</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the scalar product</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.__imul__">
<span class="sig-name descname"><span class="pre">__imul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.__imul__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.__imul__" title="Permalink to this definition"></a></dt>
<dd><p>Scalar product of this <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> with a scalar.
The operation is done inplace.</p>
<p>The scalar can be a float number of a <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> containing only
one scalar (i.e. <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.numel.html#torch.numel" title="(in PyTorch v1.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.numel()</span></code></a> should return <cite>1</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]) – a scalar</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the scalar product</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GeometricTensor.__rmatmul__">
<span class="sig-name descname"><span class="pre">__rmatmul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#GeometricTensor.__rmatmul__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GeometricTensor.__rmatmul__" title="Permalink to this definition"></a></dt>
<dd><p>Equivalent to <a class="reference internal" href="#escnn.nn.GeometricTensor.transform_fibers" title="escnn.nn.GeometricTensor.transform_fibers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.GeometricTensor.transform_fibers()</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This only transforms the fibers, not the basespace.</p>
</div>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>should this be like <cite>.transform(element)</cite> ?</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="equivariant-module">
<h2><a class="toc-backref" href="#contents">Equivariant Module</a><a class="headerlink" href="#equivariant-module" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.EquivariantModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EquivariantModule</span></span><a class="reference internal" href="../_modules/escnn/nn/modules/equivariant_module.html#EquivariantModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.EquivariantModule" title="Permalink to this definition"></a></dt>
<dd><p>Abstract base class for all equivariant modules.</p>
<p>An <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> is a subclass of <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>.
It follows that any subclass of <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> needs to implement the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code> method.
With respect to a general <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>, an <em>equivariant module</em> implements a <em>typed</em> function as
both its input and its output are associated with specific <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> s.
Therefore, usually, the inputs and the outputs of an <em>equivariant module</em> are not just instances of
<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> but <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> s.</p>
<p>As a subclass of <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>, it supports most of the commonly used methods (e.g.
<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.to" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.Module.to()</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.cuda" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.Module.cuda()</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.train" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.Module.train()</span></code></a> or
<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.eval" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.Module.eval()</span></code></a>)</p>
<p>Many equivariant modules implement a <a class="reference internal" href="#escnn.nn.EquivariantModule.export" title="escnn.nn.EquivariantModule.export"><code class="xref py py-meth docutils literal notranslate"><span class="pre">export()</span></code></a> method which converts the module
to <em>eval</em> mode and returns a pure PyTorch implementation of it.
This can be used after training to efficiently deploy the model without, for instance, the overhead of the
automatic type checking performed by all the modules in this library.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Not all modules implement this feature yet.
If the <a class="reference internal" href="#escnn.nn.EquivariantModule.export" title="escnn.nn.EquivariantModule.export"><code class="xref py py-meth docutils literal notranslate"><span class="pre">export()</span></code></a> method is called in a module which does not implement it
yet, a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> is raised.
Check the documentation of each individual module to understand if the method is implemented.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~.in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – type of the <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> expected as input</p></li>
<li><p><strong>~.out_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – type of the <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> returned as output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.EquivariantModule.evaluate_output_shape">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/equivariant_module.html#EquivariantModule.evaluate_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.EquivariantModule.evaluate_output_shape" title="Permalink to this definition"></a></dt>
<dd><p>Compute the shape the output tensor which would be generated by this module when a tensor with shape
<code class="docutils literal notranslate"><span class="pre">input_shape</span></code> is provided as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – shape of the input tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>shape of the output tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.EquivariantModule.check_equivariance">
<span class="sig-name descname"><span class="pre">check_equivariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/equivariant_module.html#EquivariantModule.check_equivariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.EquivariantModule.check_equivariance" title="Permalink to this definition"></a></dt>
<dd><p>Method that automatically tests the equivariance of the current module.
The default implementation of this method relies on <a class="reference internal" href="#escnn.nn.GeometricTensor.transform" title="escnn.nn.GeometricTensor.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.GeometricTensor.transform()</span></code></a> and uses the
the group elements in <a class="reference internal" href="#escnn.nn.FieldType.testing_elements" title="escnn.nn.FieldType.testing_elements"><code class="xref py py-attr docutils literal notranslate"><span class="pre">testing_elements</span></code></a>.</p>
<p>This method can be overwritten for custom tests.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list containing containing for each testing element a pair with that element and the corresponding
equivariance error</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.EquivariantModule.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/equivariant_module.html#EquivariantModule.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.EquivariantModule.export" title="Permalink to this definition"></a></dt>
<dd><p>Export recursively each submodule to a normal PyTorch module and set to “eval” mode.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Not all modules implement this feature yet.
If the <a class="reference internal" href="#escnn.nn.EquivariantModule.export" title="escnn.nn.EquivariantModule.export"><code class="xref py py-meth docutils literal notranslate"><span class="pre">export()</span></code></a> method is called in a module which does not implement it
yet, a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> is raised.
Check the documentation of each individual module to understand if the method is implemented.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since most modules do not use the <cite>coords</cite> attribute of the input <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a>,
once converted, they will only expect <cite>tensor</cite> but not <cite>coords</cite> in input.
There is no standard behavior for modules that explicitly use <cite>coords</cite>, so check their specific
documentation.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="utils">
<h2><a class="toc-backref" href="#contents">Utils</a><a class="headerlink" href="#utils" title="Permalink to this headline"></a></h2>
<section id="direct-sum">
<h3><a class="toc-backref" href="#contents">direct sum</a><a class="headerlink" href="#direct-sum" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="escnn.nn.tensor_directsum">
<span class="sig-name descname"><span class="pre">tensor_directsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/geometric_tensor.html#tensor_directsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.tensor_directsum" title="Permalink to this definition"></a></dt>
<dd><p>Concatenate a list of <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> s on the channels dimension (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>).
The input tensors have to be compatible: they need to have the same shape except for the channels
dimension (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>); additionally, if their <cite>coords</cite> attribute is not <cite>None</cite>, they also need to share the same
value.</p>
<p>In the resulting <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a>, the channels dimension will be associated with the direct sum
representation of the representations of the input tensors.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="escnn.group.html#escnn.group.directsum" title="escnn.group.directsum"><code class="xref py py-func docutils literal notranslate"><span class="pre">escnn.group.directsum()</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a list of <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a> s</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the direct sum of the inputs</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="linear-layers">
<h2><a class="toc-backref" href="#contents">Linear Layers</a><a class="headerlink" href="#linear-layers" title="Permalink to this headline"></a></h2>
<section id="linear">
<h3><a class="toc-backref" href="#contents">Linear</a><a class="headerlink" href="#linear" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.Linear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basisexpansion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blocks'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/linear.html#Linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.Linear" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>G-equivariant linear transformation mapping between the input and output <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> s
specified by the parameters <code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.
This operation is equivariant under the action of the <a class="reference internal" href="#escnn.nn.FieldType.fibergroup" title="escnn.nn.FieldType.fibergroup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.fibergroup</span></code></a> <span class="math notranslate nohighlight">\(G\)</span> of
<code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.</p>
<p>Specifically, let <span class="math notranslate nohighlight">\(\rho_\text{in}: G \to \GL{\R^{c_\text{in}}}\)</span> and
<span class="math notranslate nohighlight">\(\rho_\text{out}: G \to \GL{\R^{c_\text{out}}}\)</span> be the representations specified by the input and output
field types.
Then <a class="reference internal" href="#escnn.nn.Linear" title="escnn.nn.Linear"><code class="xref py py-class docutils literal notranslate"><span class="pre">Linear</span></code></a> guarantees an equivariant mapping</p>
<div class="math notranslate nohighlight">
\[W \rho_\text{in}(g) v = \rho_\text{out}(g) W v \qquad\qquad \forall g \in G, u \in \R^{c_\text{in}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_\text{in}\)</span> and <span class="math notranslate nohighlight">\(\rho_\text{out}\)</span> are the <span class="math notranslate nohighlight">\(G\)</span>-representations associated with
<code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.</p>
<p>The equivariance of a G-equivariant linear layer is guaranteed by restricting the space of weight matrices to an
equivariant subspace.</p>
<p>During training, in each forward pass the module expands the basis of G-equivariant matrices with learned weights
before performing the linear trasformation.
When <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.eval" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a> is called, the matrix is built with the current trained weights and stored
for future reuse such that no overhead of expanding the matrix remains.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.train" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a> is called, the attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">matrix</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">expanded_bias</span></code> are discarded to avoid situations of mismatch with the
learnable expansion coefficients.
See also <a class="reference internal" href="#escnn.nn.Linear.train" title="escnn.nn.Linear.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.Linear.train()</span></code></a>.</p>
<p>This behaviour can cause problems when storing the <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code></a> of a model while in
a mode and lately loading it in a model with a different mode, as the attributes of the class change.
To avoid this issue, we recommend converting the model to eval mode before storing or loading the state
dictionary.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To ensure compatibility with both :class`torch.nn.Linear` and :class`~escnn.nn.GeometricTensor`, this
module supports only input tensors with two dimensions <cite>(batch_size, number_features)</cite>.</p>
</div>
<p>The learnable expansion coefficients of the this module can be initialized with the methods in
<a class="reference internal" href="#module-escnn.nn.init" title="escnn.nn.init"><code class="xref py py-mod docutils literal notranslate"><span class="pre">escnn.nn.init</span></code></a>.
By default, the weights are initialized in the constructors using <a class="reference internal" href="#escnn.nn.init.generalized_he_init" title="escnn.nn.init.generalized_he_init"><code class="xref py py-func docutils literal notranslate"><span class="pre">generalized_he_init()</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This initialization procedure can be extremely slow for wide layers.
In case initializing the model is not required (e.g. before loading the state dict of a pre-trained model)
or another initialization method is preferred (e.g. <a class="reference internal" href="#escnn.nn.init.deltaorthonormal_init" title="escnn.nn.init.deltaorthonormal_init"><code class="xref py py-func docutils literal notranslate"><span class="pre">deltaorthonormal_init()</span></code></a>), the
parameter <code class="docutils literal notranslate"><span class="pre">initialize</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to avoid unnecessary overhead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the input field, specifying its transformation law</p></li>
<li><p><strong>out_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the output field, specifying its transformation law</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to add a bias to the output (only to fields which contain a
trivial irrep) or not. Default <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>basisexpansion</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the basis expansion algorithm to use. You can ignore this attribute.</p></li>
<li><p><strong>recompute</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, recomputes a new basis for the equivariant kernels.
By Default (<code class="docutils literal notranslate"><span class="pre">False</span></code>), it  caches the basis built or reuse a cached one, if it is found.</p></li>
<li><p><strong>initialize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – initialize the weights of the model. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>~.weights</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the learnable parameters which are used to expand the matrix</p></li>
<li><p><strong>~.matrix</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the matrix obtained by expanding the parameters in <code class="xref py py-attr docutils literal notranslate"><span class="pre">weights</span></code></p></li>
<li><p><strong>~.bias</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the learnable parameters which are used to expand the bias, if <code class="docutils literal notranslate"><span class="pre">bias=True</span></code></p></li>
<li><p><strong>~.expanded_bias</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the equivariant bias which is summed to the output, obtained by expanding
the parameters in <code class="xref py py-attr docutils literal notranslate"><span class="pre">bias</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.Linear.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/linear.html#Linear.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.Linear.forward" title="Permalink to this definition"></a></dt>
<dd><p>Convolve the input with the expanded filter and bias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – input feature field transforming according to <code class="docutils literal notranslate"><span class="pre">in_type</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>output feature field transforming according to <code class="docutils literal notranslate"><span class="pre">out_type</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="escnn.nn.Linear.basisexpansion">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basisexpansion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#escnn.nn.modules.basismanager.BasisManager" title="escnn.nn.modules.basismanager.basismanager.BasisManager"><span class="pre">escnn.nn.modules.basismanager.basismanager.BasisManager</span></a></em><a class="headerlink" href="#escnn.nn.Linear.basisexpansion" title="Permalink to this definition"></a></dt>
<dd><p>Submodule which takes care of building the filter.</p>
<p>It uses the learnt <code class="docutils literal notranslate"><span class="pre">weights</span></code> to expand a basis and returns a filter in the usual form used by conventional
convolutional modules.
It uses the learned <code class="docutils literal notranslate"><span class="pre">weights</span></code> to expand the kernel in the G-steerable basis and returns it in the shape
<span class="math notranslate nohighlight">\((c_\text{out}, c_\text{in}, s^d)\)</span>, where <span class="math notranslate nohighlight">\(s\)</span> is the <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code> and <span class="math notranslate nohighlight">\(d\)</span> is the
dimensionality of the base space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.Linear.expand_parameters">
<span class="sig-name descname"><span class="pre">expand_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/linear.html#Linear.expand_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.Linear.expand_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Expand the matrix in terms of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.R2Conv.weights</span></code> and the
expanded bias in terms of <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.R2Conv.bias</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the expanded matrix and bias</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.Linear.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/linear.html#Linear.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.Linear.train" title="Permalink to this definition"></a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">mode=True</span></code>, the method sets the module in training mode and discards the <code class="xref py py-attr docutils literal notranslate"><span class="pre">filter</span></code>
and <code class="xref py py-attr docutils literal notranslate"><span class="pre">expanded_bias</span></code> attributes.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">mode=False</span></code>, it sets the module in evaluation mode. Moreover, the method builds the filter and the bias
using the current values of the trainable parameters and store them in <code class="xref py py-attr docutils literal notranslate"><span class="pre">filter</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">expanded_bias</span></code> such that they are not recomputed at each forward pass.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This behaviour can cause problems when storing the <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code></a> of a model while in
a mode and lately loading it in a model with a different mode, as the attributes of this class change.
To avoid this issue, we recommend converting the model to eval mode before storing or loading the state
dictionary.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to set training mode (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or evaluation mode (<code class="docutils literal notranslate"><span class="pre">False</span></code>).
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.Linear.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/linear.html#Linear.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.Linear.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="steerable-dense-convolution">
<h2><a class="toc-backref" href="#contents">Steerable Dense Convolution</a><a class="headerlink" href="#steerable-dense-convolution" title="Permalink to this headline"></a></h2>
<section id="r2conv">
<h3><a class="toc-backref" href="#contents">R2Conv</a><a class="headerlink" href="#r2conv" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.R2Conv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R2Conv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zeros'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r2convolution.html#R2Conv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R2Conv" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.conv.rd_convolution._RdConv</span></code></p>
<p>G-steerable planar convolution mapping between the input and output <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> s specified by
the parameters <code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.
This operation is equivariant under the action of <span class="math notranslate nohighlight">\(\R^2\rtimes G\)</span> where <span class="math notranslate nohighlight">\(G\)</span> is the
<a class="reference internal" href="#escnn.nn.FieldType.fibergroup" title="escnn.nn.FieldType.fibergroup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.fibergroup</span></code></a> of <code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.</p>
<p>Specifically, let <span class="math notranslate nohighlight">\(\rho_\text{in}: G \to \GL{\R^{c_\text{in}}}\)</span> and
<span class="math notranslate nohighlight">\(\rho_\text{out}: G \to \GL{\R^{c_\text{out}}}\)</span> be the representations specified by the input and output
field types.
Then <a class="reference internal" href="#escnn.nn.R2Conv" title="escnn.nn.R2Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">R2Conv</span></code></a> guarantees an equivariant mapping</p>
<div class="math notranslate nohighlight">
\[\kappa \star [\mathcal{T}^\text{in}_{g,u} . f] = \mathcal{T}^\text{out}_{g,u} . [\kappa \star f] \qquad\qquad \forall g \in G, u \in \R^2\]</div>
<p>where the transformation of the input and output fields are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}[\mathcal{T}^\text{in}_{g,u} . f](x) &amp;= \rho_\text{in}(g)f(g^{-1} (x - u)) \\
[\mathcal{T}^\text{out}_{g,u} . f](x) &amp;= \rho_\text{out}(g)f(g^{-1} (x - u)) \\\end{split}\]</div>
<p>The equivariance of G-steerable convolutions is guaranteed by restricting the space of convolution kernels to an
equivariant subspace.
As proven in <a class="reference external" href="https://arxiv.org/abs/1807.02547">3D Steerable CNNs</a>, this parametrizes the <em>most general
equivariant convolutional map</em> between the input and output fields.
For feature fields on <span class="math notranslate nohighlight">\(\R^2\)</span> (e.g. images), the complete G-steerable kernel spaces for <span class="math notranslate nohighlight">\(G \leq \O2\)</span>
is derived in <a class="reference external" href="https://arxiv.org/abs/1911.08251">General E(2)-Equivariant Steerable CNNs</a>.</p>
<p>During training, in each forward pass the module expands the basis of G-steerable kernels with learned weights
before calling <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.functional.conv2d.html#torch.nn.functional.conv2d" title="(in PyTorch v1.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.functional.conv2d()</span></code></a>.
When <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.eval" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a> is called, the filter is built with the current trained weights and stored
for future reuse such that no overhead of expanding the kernel remains.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.train" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a> is called, the attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">filter</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">expanded_bias</span></code> are discarded to avoid situations of mismatch with the
learnable expansion coefficients.
See also <code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.R2Conv.train()</span></code>.</p>
<p>This behaviour can cause problems when storing the <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code></a> of a model while in
a mode and lately loading it in a model with a different mode, as the attributes of the class change.
To avoid this issue, we recommend converting the model to eval mode before storing or loading the state
dictionary.</p>
</div>
<p>The learnable expansion coefficients of the this module can be initialized with the methods in
<a class="reference internal" href="#module-escnn.nn.init" title="escnn.nn.init"><code class="xref py py-mod docutils literal notranslate"><span class="pre">escnn.nn.init</span></code></a>.
By default, the weights are initialized in the constructors using <a class="reference internal" href="#escnn.nn.init.generalized_he_init" title="escnn.nn.init.generalized_he_init"><code class="xref py py-func docutils literal notranslate"><span class="pre">generalized_he_init()</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This initialization procedure can be extremely slow for wide layers.
In case initializing the model is not required (e.g. before loading the state dict of a pre-trained model)
or another initialization method is preferred (e.g. <a class="reference internal" href="#escnn.nn.init.deltaorthonormal_init" title="escnn.nn.init.deltaorthonormal_init"><code class="xref py py-func docutils literal notranslate"><span class="pre">deltaorthonormal_init()</span></code></a>), the
parameter <code class="docutils literal notranslate"><span class="pre">initialize</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to avoid unnecessary overhead.</p>
</div>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">basisexpansion</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma</span></code>, <code class="docutils literal notranslate"><span class="pre">frequencies_cutoff</span></code>, <code class="docutils literal notranslate"><span class="pre">rings</span></code> and <code class="docutils literal notranslate"><span class="pre">maximum_offset</span></code> are
optional parameters used to control how the basis for the filters is built, how it is sampled on the filter
grid and how it is expanded to build the filter. We suggest to keep these default values.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the input field, specifying its transformation law</p></li>
<li><p><strong>out_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the output field, specifying its transformation law</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the size of the (square) filter</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – implicit zero paddings on both sides of the input. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the stride of the kernel. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the spacing between kernel elements. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>padding_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">zeros</span></code>, <code class="docutils literal notranslate"><span class="pre">reflect</span></code>, <code class="docutils literal notranslate"><span class="pre">replicate</span></code> or <code class="docutils literal notranslate"><span class="pre">circular</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">zeros</span></code></p></li>
<li><p><strong>groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of blocked connections from input channels to output channels.
It allows depthwise convolution. When used, the input and output types need to be
divisible in <code class="docutils literal notranslate"><span class="pre">groups</span></code> groups, all equal to each other.
Default: <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to add a bias to the output (only to fields which contain a
trivial irrep) or not. Default <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – width of each ring where the bases are sampled. If only one scalar
is passed, it is used for all rings.</p></li>
<li><p><strong>frequencies_cutoff</strong> (<em>callable</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – function mapping the radii of the basis elements to the
maximum frequency accepted. If a float values is passed, the maximum frequency is equal to the
radius times this factor. By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), a more complex policy is used.</p></li>
<li><p><strong>rings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – radii of the rings where to sample the bases</p></li>
<li><p><strong>maximum_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of additional (aliased) frequencies in the intertwiners for finite
groups. By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), all additional frequencies allowed by the frequencies cut-off
are used.</p></li>
<li><p><strong>recompute</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, recomputes a new basis for the equivariant kernels.
By Default (<code class="docutils literal notranslate"><span class="pre">False</span></code>), it  caches the basis built or reuse a cached one, if it is found.</p></li>
<li><p><strong>basis_filter</strong> (<em>callable</em><em>, </em><em>optional</em>) – function which takes as input a descriptor of a basis element
(as a dictionary) and returns a boolean value: whether to preserve (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or discard (<code class="docutils literal notranslate"><span class="pre">False</span></code>)
the basis element. By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), no filtering is applied.</p></li>
<li><p><strong>initialize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – initialize the weights of the model. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>~.weights</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the learnable parameters which are used to expand the kernel</p></li>
<li><p><strong>~.filter</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the convolutional kernel obtained by expanding the parameters
in <code class="xref py py-attr docutils literal notranslate"><span class="pre">weights</span></code></p></li>
<li><p><strong>~.bias</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the learnable parameters which are used to expand the bias, if <code class="docutils literal notranslate"><span class="pre">bias=True</span></code></p></li>
<li><p><strong>~.expanded_bias</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the equivariant bias which is summed to the output, obtained by expanding
the parameters in <code class="xref py py-attr docutils literal notranslate"><span class="pre">bias</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.R2Conv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r2convolution.html#R2Conv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R2Conv.forward" title="Permalink to this definition"></a></dt>
<dd><p>Convolve the input with the expanded filter and bias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – input feature field transforming according to <code class="docutils literal notranslate"><span class="pre">in_type</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>output feature field transforming according to <code class="docutils literal notranslate"><span class="pre">out_type</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.R2Conv.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r2convolution.html#R2Conv.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R2Conv.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Conv2d.html#torch.nn.Conv2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Conv2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="r3conv">
<h3><a class="toc-backref" href="#contents">R3Conv</a><a class="headerlink" href="#r3conv" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.R3Conv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R3Conv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zeros'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r3convolution.html#R3Conv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R3Conv" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.conv.rd_convolution._RdConv</span></code></p>
<p>G-steerable planar convolution mapping between the input and output <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> s specified by
the parameters <code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.
This operation is equivariant under the action of <span class="math notranslate nohighlight">\(\R^3\rtimes G\)</span> where <span class="math notranslate nohighlight">\(G\)</span> is the
<a class="reference internal" href="#escnn.nn.FieldType.fibergroup" title="escnn.nn.FieldType.fibergroup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.fibergroup</span></code></a> of <code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.</p>
<p>Specifically, let <span class="math notranslate nohighlight">\(\rho_\text{in}: G \to \GL{\R^{c_\text{in}}}\)</span> and
<span class="math notranslate nohighlight">\(\rho_\text{out}: G \to \GL{\R^{c_\text{out}}}\)</span> be the representations specified by the input and output
field types.
Then <a class="reference internal" href="#escnn.nn.R2Conv" title="escnn.nn.R2Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">R2Conv</span></code></a> guarantees an equivariant mapping</p>
<div class="math notranslate nohighlight">
\[\kappa \star [\mathcal{T}^\text{in}_{g,u} . f] = \mathcal{T}^\text{out}_{g,u} . [\kappa \star f] \qquad\qquad \forall g \in G, u \in \R^3\]</div>
<p>where the transformation of the input and output fields are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}[\mathcal{T}^\text{in}_{g,u} . f](x) &amp;= \rho_\text{in}(g)f(g^{-1} (x - u)) \\
[\mathcal{T}^\text{out}_{g,u} . f](x) &amp;= \rho_\text{out}(g)f(g^{-1} (x - u)) \\\end{split}\]</div>
<p>The equivariance of G-steerable convolutions is guaranteed by restricting the space of convolution kernels to an
equivariant subspace.
As proven in <a class="reference external" href="https://arxiv.org/abs/1807.02547">3D Steerable CNNs</a>, this parametrizes the <em>most general
equivariant convolutional map</em> between the input and output fields.</p>
<p>During training, in each forward pass the module expands the basis of G-steerable kernels with learned weights
before calling <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.functional.conv2d.html#torch.nn.functional.conv2d" title="(in PyTorch v1.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.functional.conv2d()</span></code></a>.
When <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.eval" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code></a> is called, the filter is built with the current trained weights and stored
for future reuse such that no overhead of expanding the kernel remains.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.train" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a> is called, the attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">filter</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">expanded_bias</span></code> are discarded to avoid situations of mismatch with the
learnable expansion coefficients.
See also <code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.R3Conv.train()</span></code>.</p>
<p>This behaviour can cause problems when storing the <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict" title="(in PyTorch v1.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code></a> of a model while in
a mode and lately loading it in a model with a different mode, as the attributes of the class change.
To avoid this issue, we recommend converting the model to eval mode before storing or loading the state
dictionary.</p>
</div>
<p>The learnable expansion coefficients of the this module can be initialized with the methods in
<a class="reference internal" href="#module-escnn.nn.init" title="escnn.nn.init"><code class="xref py py-mod docutils literal notranslate"><span class="pre">escnn.nn.init</span></code></a>.
By default, the weights are initialized in the constructors using <a class="reference internal" href="#escnn.nn.init.generalized_he_init" title="escnn.nn.init.generalized_he_init"><code class="xref py py-func docutils literal notranslate"><span class="pre">generalized_he_init()</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This initialization procedure can be extremely slow for wide layers.
In case initializing the model is not required (e.g. before loading the state dict of a pre-trained model)
or another initialization method is preferred (e.g. <a class="reference internal" href="#escnn.nn.init.deltaorthonormal_init" title="escnn.nn.init.deltaorthonormal_init"><code class="xref py py-func docutils literal notranslate"><span class="pre">deltaorthonormal_init()</span></code></a>), the
parameter <code class="docutils literal notranslate"><span class="pre">initialize</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to avoid unnecessary overhead.</p>
</div>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">sigma</span></code>, <code class="docutils literal notranslate"><span class="pre">frequencies_cutoff</span></code> and <code class="docutils literal notranslate"><span class="pre">rings</span></code> are
optional parameters used to control how the basis for the filters is built, how it is sampled on the filter
grid and how it is expanded to build the filter. We suggest to keep these default values.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the input field, specifying its transformation law</p></li>
<li><p><strong>out_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the output field, specifying its transformation law</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the size of the (square) filter</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – implicit zero paddings on both sides of the input. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the stride of the kernel. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the spacing between kernel elements. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>padding_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">zeros</span></code>, <code class="docutils literal notranslate"><span class="pre">reflect</span></code>, <code class="docutils literal notranslate"><span class="pre">replicate</span></code> or <code class="docutils literal notranslate"><span class="pre">circular</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">zeros</span></code></p></li>
<li><p><strong>groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of blocked connections from input channels to output channels.
It allows depthwise convolution. When used, the input and output types need to be
divisible in <code class="docutils literal notranslate"><span class="pre">groups</span></code> groups, all equal to each other.
Default: <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to add a bias to the output (only to fields which contain a
trivial irrep) or not. Default <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – width of each ring where the bases are sampled. If only one scalar
is passed, it is used for all rings.</p></li>
<li><p><strong>frequencies_cutoff</strong> (<em>callable</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – function mapping the radii of the basis elements to the
maximum frequency accepted. If a float values is passed, the maximum frequency is equal to the
radius times this factor. By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), a more complex policy is used.</p></li>
<li><p><strong>rings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – radii of the rings where to sample the bases</p></li>
<li><p><strong>recompute</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, recomputes a new basis for the equivariant kernels.
By Default (<code class="docutils literal notranslate"><span class="pre">False</span></code>), it  caches the basis built or reuse a cached one, if it is found.</p></li>
<li><p><strong>basis_filter</strong> (<em>callable</em><em>, </em><em>optional</em>) – function which takes as input a descriptor of a basis element
(as a dictionary) and returns a boolean value: whether to preserve (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or discard (<code class="docutils literal notranslate"><span class="pre">False</span></code>)
the basis element. By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), no filtering is applied.</p></li>
<li><p><strong>initialize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – initialize the weights of the model. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>~.weights</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the learnable parameters which are used to expand the kernel</p></li>
<li><p><strong>~.filter</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the convolutional kernel obtained by expanding the parameters
in <code class="xref py py-attr docutils literal notranslate"><span class="pre">weights</span></code></p></li>
<li><p><strong>~.bias</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the learnable parameters which are used to expand the bias, if <code class="docutils literal notranslate"><span class="pre">bias=True</span></code></p></li>
<li><p><strong>~.expanded_bias</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the equivariant bias which is summed to the output, obtained by expanding
the parameters in <code class="xref py py-attr docutils literal notranslate"><span class="pre">bias</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.R3Conv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r3convolution.html#R3Conv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R3Conv.forward" title="Permalink to this definition"></a></dt>
<dd><p>Convolve the input with the expanded filter and bias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – input feature field transforming according to <code class="docutils literal notranslate"><span class="pre">in_type</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>output feature field transforming according to <code class="docutils literal notranslate"><span class="pre">out_type</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.R3Conv.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r3convolution.html#R3Conv.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R3Conv.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Conv2d.html#torch.nn.Conv2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Conv2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="r3icoconv">
<h3><a class="toc-backref" href="#contents">R3IcoConv</a><a class="headerlink" href="#r3icoconv" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.R3IcoConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R3IcoConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zeros'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ico'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r3_ico_convolution.html#R3IcoConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R3IcoConv" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.R3Conv" title="escnn.nn.modules.conv.r3convolution.R3Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.conv.r3convolution.R3Conv</span></code></a></p>
<p>Icosahedral-steerable volumetric convolution mapping between the input and output <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> s specified by
the parameters <code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.
This operation is equivariant under the action of <span class="math notranslate nohighlight">\(\R^3\rtimes I\)</span> where <span class="math notranslate nohighlight">\(I\)</span>
(the <a class="reference internal" href="escnn.group.html#escnn.group.Icosahedral" title="escnn.group.Icosahedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Icosahedral</span></code></a> group) is the <a class="reference internal" href="#escnn.nn.FieldType.fibergroup" title="escnn.nn.FieldType.fibergroup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.fibergroup</span></code></a> of
<code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.</p>
<p>This class is mostly similar to <a class="reference internal" href="#escnn.nn.R3Conv" title="escnn.nn.R3Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">R3Conv</span></code></a>, with the only difference that it only supports the
group <a class="reference internal" href="escnn.group.html#escnn.group.Icosahedral" title="escnn.group.Icosahedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Icosahedral</span></code></a> since it uses a kernel basis which is specific for this group.</p>
<p>The argument <code class="docutils literal notranslate"><span class="pre">`frequencies_cutoff`</span></code> of <a class="reference internal" href="#escnn.nn.R3Conv" title="escnn.nn.R3Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">R3Conv</span></code></a> is not supported here since the steerable
kernels are not generated from a band-limited set of harmonic functions.</p>
<p>Instead, the argument <code class="docutils literal notranslate"><span class="pre">`samples`</span></code> specifies the polyhedron (symmetric with respect to the
<a class="reference internal" href="escnn.group.html#escnn.group.Icosahedral" title="escnn.group.Icosahedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Icosahedral</span></code></a>  group) whose vertices are used to define the kernel on <span class="math notranslate nohighlight">\(\R^3\)</span>.
The supported polyhedrons are <code class="docutils literal notranslate"><span class="pre">`&quot;ico&quot;`</span></code> (the 12 vertices of the icosahedron), <code class="docutils literal notranslate"><span class="pre">`&quot;dodeca&quot;`</span></code> (the 20 vertices
of the dodecahedron) or <code class="docutils literal notranslate"><span class="pre">`&quot;icosidodeca&quot;`</span></code> (the 30 vertices of the icosidodecahedron, which correspond to the
centers of the 30 edges of either the icosahedron or the dodecahedron).</p>
<p>For each ring <code class="docutils literal notranslate"><span class="pre">`r`</span></code> in <code class="docutils literal notranslate"><span class="pre">`rings`</span></code>, the polyhedron specified in embedded in the sphere of radius <code class="docutils literal notranslate"><span class="pre">`r`</span></code>.
The analytical kernel, which is only defined on the vertices of this polyhedron, is then “diffused” in the
ambient space <span class="math notranslate nohighlight">\(\R^3\)</span> by means of a small Gaussian kernel with std <code class="docutils literal notranslate"><span class="pre">`sigma`</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the input field, specifying its transformation law</p></li>
<li><p><strong>out_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the output field, specifying its transformation law</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the size of the (square) filter</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – implicit zero paddings on both sides of the input. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the stride of the kernel. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the spacing between kernel elements. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>padding_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">zeros</span></code>, <code class="docutils literal notranslate"><span class="pre">reflect</span></code>, <code class="docutils literal notranslate"><span class="pre">replicate</span></code> or <code class="docutils literal notranslate"><span class="pre">circular</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">zeros</span></code></p></li>
<li><p><strong>groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of blocked connections from input channels to output channels.
It allows depthwise convolution. When used, the input and output types need to be
divisible in <code class="docutils literal notranslate"><span class="pre">groups</span></code> groups, all equal to each other.
Default: <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to add a bias to the output (only to fields which contain a
trivial irrep) or not. Default <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – width of each ring where the bases are sampled. If only one scalar
is passed, it is used for all rings.</p></li>
<li><p><strong>rings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – radii of the rings where to sample the bases</p></li>
<li><p><strong>recompute</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, recomputes a new basis for the equivariant kernels.
By Default (<code class="docutils literal notranslate"><span class="pre">False</span></code>), it  caches the basis built or reuse a cached one, if it is found.</p></li>
<li><p><strong>basis_filter</strong> (<em>callable</em><em>, </em><em>optional</em>) – function which takes as input a descriptor of a basis element
(as a dictionary) and returns a boolean value: whether to preserve (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or discard (<code class="docutils literal notranslate"><span class="pre">False</span></code>)
the basis element. By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), no filtering is applied.</p></li>
<li><p><strong>initialize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – initialize the weights of the model. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="r2convtransposed">
<h3><a class="toc-backref" href="#contents">R2ConvTransposed</a><a class="headerlink" href="#r2convtransposed" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.R2ConvTransposed">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R2ConvTransposed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r2_transposed_convolution.html#R2ConvTransposed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R2ConvTransposed" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.conv.rd_transposed_convolution._RdConvTransposed</span></code></p>
<p>Transposed G-steerable planar convolution layer.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Transposed convolution can produce artifacts which can harm the overall equivariance of the model.
We suggest using <a class="reference internal" href="#escnn.nn.R2Upsampling" title="escnn.nn.R2Upsampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">R2Upsampling</span></code></a> combined with <a class="reference internal" href="#escnn.nn.R2Conv" title="escnn.nn.R2Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">R2Conv</span></code></a> to perform
upsampling.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For additional information about the parameters and the methods of this class, see <a class="reference internal" href="#escnn.nn.R2Conv" title="escnn.nn.R2Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.R2Conv</span></code></a>.
The two modules are essentially the same, except for the type of convolution used.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the input field</p></li>
<li><p><strong>out_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the output field</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the size of the filter</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – implicit zero paddings on both sides of the input. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>output_padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – implicit zero paddings on both sides of the input. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the stride of the convolving kernel. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the spacing between kernel elements. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of blocked connections from input channels to output channels.
Default: <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to add a bias to the output (only to fields which contain a
trivial irrep) or not. Default <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>initialize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – initialize the weights of the model. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.R2ConvTransposed.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r2_transposed_convolution.html#R2ConvTransposed.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R2ConvTransposed.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.ConvTranspose2d.html#torch.nn.ConvTranspose2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.ConvTranspose2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="r3convtransposed">
<h3><a class="toc-backref" href="#contents">R3ConvTransposed</a><a class="headerlink" href="#r3convtransposed" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.R3ConvTransposed">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R3ConvTransposed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r3_transposed_convolution.html#R3ConvTransposed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R3ConvTransposed" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.conv.rd_transposed_convolution._RdConvTransposed</span></code></p>
<p>Transposed G-steerable planar convolution layer.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Transposed convolution can produce artifacts which can harm the overall equivariance of the model.
We suggest using <a class="reference internal" href="#escnn.nn.R2Upsampling" title="escnn.nn.R2Upsampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">R2Upsampling</span></code></a> combined with <a class="reference internal" href="#escnn.nn.R3Conv" title="escnn.nn.R3Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">R3Conv</span></code></a> to perform
upsampling.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For additional information about the parameters and the methods of this class, see <a class="reference internal" href="#escnn.nn.R3Conv" title="escnn.nn.R3Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.R3Conv</span></code></a>.
The two modules are essentially the same, except for the type of convolution used.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the input field</p></li>
<li><p><strong>out_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the output field</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the size of the filter</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – implicit zero paddings on both sides of the input. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>output_padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – implicit zero paddings on both sides of the input. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the stride of the convolving kernel. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the spacing between kernel elements. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of blocked connections from input channels to output channels.
Default: <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to add a bias to the output (only to fields which contain a
trivial irrep) or not. Default <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>initialize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – initialize the weights of the model. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.R3ConvTransposed.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r3_transposed_convolution.html#R3ConvTransposed.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R3ConvTransposed.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.ConvTranspose2d.html#torch.nn.ConvTranspose2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.ConvTranspose2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="r3icoconvtransposed">
<h3><a class="toc-backref" href="#contents">R3IcoConvTransposed</a><a class="headerlink" href="#r3icoconvtransposed" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.R3IcoConvTransposed">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R3IcoConvTransposed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ico'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/conv/r3_ico_transposed_convolution.html#R3IcoConvTransposed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R3IcoConvTransposed" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.R3ConvTransposed" title="escnn.nn.modules.conv.r3_transposed_convolution.R3ConvTransposed"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.conv.r3_transposed_convolution.R3ConvTransposed</span></code></a></p>
<p>Icosahedral-steerable volumetric convolution mapping between the input and output <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a> s specified by
the parameters <code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.
This operation is equivariant under the action of <span class="math notranslate nohighlight">\(\R^3\rtimes I\)</span> where <span class="math notranslate nohighlight">\(I\)</span>
(the <a class="reference internal" href="escnn.group.html#escnn.group.Icosahedral" title="escnn.group.Icosahedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Icosahedral</span></code></a> group) is the <a class="reference internal" href="#escnn.nn.FieldType.fibergroup" title="escnn.nn.FieldType.fibergroup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.nn.FieldType.fibergroup</span></code></a> of
<code class="docutils literal notranslate"><span class="pre">in_type</span></code> and <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.</p>
<p>This class is mostly similar to <a class="reference internal" href="#escnn.nn.R3ConvTransposed" title="escnn.nn.R3ConvTransposed"><code class="xref py py-class docutils literal notranslate"><span class="pre">R3ConvTransposed</span></code></a>, with the only difference that it only
supports the group <a class="reference internal" href="escnn.group.html#escnn.group.Icosahedral" title="escnn.group.Icosahedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Icosahedral</span></code></a> since it uses a kernel basis which is specific for
this group.</p>
<p>The argument <code class="docutils literal notranslate"><span class="pre">`frequencies_cutoff`</span></code> of <a class="reference internal" href="#escnn.nn.R3ConvTransposed" title="escnn.nn.R3ConvTransposed"><code class="xref py py-class docutils literal notranslate"><span class="pre">R3ConvTransposed</span></code></a> is not supported here since the
steerable kernels are not generated from a band-limited set of harmonic functions.</p>
<p>Instead, the argument <code class="docutils literal notranslate"><span class="pre">`samples`</span></code> specifies the polyhedron (symmetric with respect to the
<a class="reference internal" href="escnn.group.html#escnn.group.Icosahedral" title="escnn.group.Icosahedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Icosahedral</span></code></a>  group) whose vertices are used to define the kernel on <span class="math notranslate nohighlight">\(\R^3\)</span>.
The supported polyhedrons are <code class="docutils literal notranslate"><span class="pre">`&quot;ico&quot;`</span></code> (the 12 vertices of the icosahedron), <code class="docutils literal notranslate"><span class="pre">`&quot;dodeca&quot;`</span></code> (the 20 vertices
of the dodecahedron) or <code class="docutils literal notranslate"><span class="pre">`&quot;icosidodeca&quot;`</span></code> (the 30 vertices of the icosidodecahedron, which correspond to the
centers of the 30 edges of either the icosahedron or the dodecahedron).</p>
<p>For each ring <code class="docutils literal notranslate"><span class="pre">`r`</span></code> in <code class="docutils literal notranslate"><span class="pre">`rings`</span></code>, the polyhedron specified in embedded in the sphere of radius <code class="docutils literal notranslate"><span class="pre">`r`</span></code>.
The analytical kernel, which is only defined on the vertices of this polyhedron, is then “diffused” in the
ambient space <span class="math notranslate nohighlight">\(\R^3\)</span> by means of a small Gaussian kernel with std <code class="docutils literal notranslate"><span class="pre">`sigma`</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the input field, specifying its transformation law</p></li>
<li><p><strong>out_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the type of the output field, specifying its transformation law</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the size of the (square) filter</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – implicit zero paddings on both sides of the input. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>output_padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – implicit zero paddings on both sides of the input. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the stride of the kernel. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the spacing between kernel elements. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of blocked connections from input channels to output channels.
It allows depthwise convolution. When used, the input and output types need to be
divisible in <code class="docutils literal notranslate"><span class="pre">groups</span></code> groups, all equal to each other.
Default: <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to add a bias to the output (only to fields which contain a
trivial irrep) or not. Default <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – width of each ring where the bases are sampled. If only one scalar
is passed, it is used for all rings.</p></li>
<li><p><strong>rings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – radii of the rings where to sample the bases</p></li>
<li><p><strong>recompute</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, recomputes a new basis for the equivariant kernels.
By Default (<code class="docutils literal notranslate"><span class="pre">False</span></code>), it  caches the basis built or reuse a cached one, if it is found.</p></li>
<li><p><strong>basis_filter</strong> (<em>callable</em><em>, </em><em>optional</em>) – function which takes as input a descriptor of a basis element
(as a dictionary) and returns a boolean value: whether to preserve (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or discard (<code class="docutils literal notranslate"><span class="pre">False</span></code>)
the basis element. By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), no filtering is applied.</p></li>
<li><p><strong>initialize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – initialize the weights of the model. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="steerable-point-convolution">
<h2><a class="toc-backref" href="#contents">Steerable Point Convolution</a><a class="headerlink" href="#steerable-point-convolution" title="Permalink to this headline"></a></h2>
<section id="r2pointconv">
<h3><a class="toc-backref" href="#contents">R2PointConv</a><a class="headerlink" href="#r2pointconv" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.R2PointConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R2PointConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pointconv/r2_point_convolution.html#R2PointConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R2PointConv" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.pointconv.rd_point_convolution._RdPointConv</span></code></p>
</dd></dl>

</section>
<section id="r3pointconv">
<h3><a class="toc-backref" href="#contents">R3PointConv</a><a class="headerlink" href="#r3pointconv" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.R3PointConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R3PointConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pointconv/r3_point_convolution.html#R3PointConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R3PointConv" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.pointconv.rd_point_convolution._RdPointConv</span></code></p>
</dd></dl>

</section>
</section>
<section id="basismanager">
<h2><a class="toc-backref" href="#contents">BasisManager</a><a class="headerlink" href="#basismanager" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.modules.basismanager.BasisManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BasisManager</span></span><a class="reference internal" href="../_modules/escnn/nn/modules/basismanager/basismanager.html#BasisManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.modules.basismanager.BasisManager" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Abstract class defining the <em>interface</em> for the different modules which deal with the filter basis.
It provides a few methods which can be used to retrieve information about the basis and each of its elements.</p>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.modules.basismanager.BasisManager.get_element_info">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_element_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/basismanager/basismanager.html#BasisManager.get_element_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.modules.basismanager.BasisManager.get_element_info" title="Permalink to this definition"></a></dt>
<dd><p>Method that returns the information associated to a basis element</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – index of the basis element</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary containing the information</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.modules.basismanager.BasisManager.get_basis_info">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/basismanager/basismanager.html#BasisManager.get_basis_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.modules.basismanager.BasisManager.get_basis_info" title="Permalink to this definition"></a></dt>
<dd><p>Method that returns an iterable over all basis elements’ attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>an iterable over all the basis elements’ attributes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.modules.basismanager.BasisManager.dimension">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/basismanager/basismanager.html#BasisManager.dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.modules.basismanager.BasisManager.dimension" title="Permalink to this definition"></a></dt>
<dd><p>The dimensionality of the basis and, so, the number of weights needed to expand it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dimensionality of the basis</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.modules.basismanager.BlocksBasisExpansion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BlocksBasisExpansion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_reprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_reprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/basismanager/basisexpansion_blocks.html#BlocksBasisExpansion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.modules.basismanager.BlocksBasisExpansion" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code>, <a class="reference internal" href="#escnn.nn.modules.basismanager.BasisManager" title="escnn.nn.modules.basismanager.basismanager.BasisManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.basismanager.basismanager.BasisManager</span></code></a></p>
<p>Method that performs the expansion of a (already sampled) filter basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_reprs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – the input field type</p></li>
<li><p><strong>out_reprs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – the output field type</p></li>
<li><p><strong>basis_generator</strong> (<em>callable</em>) – method that generates the analytical filter basis</p></li>
<li><p><strong>points</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>ndarray</em></a>) – points where the analytical basis should be sampled</p></li>
<li><p><strong>basis_filter</strong> (<em>callable</em><em>, </em><em>optional</em>) – filter for the basis elements. Should take a dictionary containing an
element’s attributes and return whether to keep it or not.</p></li>
<li><p><strong>recompute</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to recompute new bases or reuse, if possible, already built tensors.</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><strong>~BlocksBasisExpansion.S</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of points where the filters are sampled</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.modules.basismanager.BlocksBasisExpansion.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/basismanager/basisexpansion_blocks.html#BlocksBasisExpansion.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.modules.basismanager.BlocksBasisExpansion.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward step of the Module which expands the basis and returns the filter built</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>weights</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the learnable weights used to linearly combine the basis filters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filter built</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.modules.basismanager.BlocksBasisSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BlocksBasisSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_reprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_reprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/basismanager/basissampler_blocks.html#BlocksBasisSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.modules.basismanager.BlocksBasisSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code>, <a class="reference internal" href="#escnn.nn.modules.basismanager.BasisManager" title="escnn.nn.modules.basismanager.basismanager.BasisManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.basismanager.basismanager.BasisManager</span></code></a></p>
<p>Module which performs the expansion of an analytical filter basis and samples it on arbitrary input points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_reprs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – the input field type</p></li>
<li><p><strong>out_reprs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – the output field type</p></li>
<li><p><strong>basis_generator</strong> (<em>callable</em>) – method that generates the analytical filter basis</p></li>
<li><p><strong>basis_filter</strong> (<em>callable</em><em>, </em><em>optional</em>) – filter for the basis elements. Should take a dictionary containing an
element’s attributes and return whether to keep it or not.</p></li>
<li><p><strong>recompute</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – whether to recompute new bases or reuse, if possible, already built tensors.</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><strong>~BlocksBasisSampler.S</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of points where the filters are sampled</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.modules.basismanager.BlocksBasisSampler.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/basismanager/basissampler_blocks.html#BlocksBasisSampler.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.modules.basismanager.BlocksBasisSampler.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward step of the Module which expands the basis, samples it on the input <cite>points</cite> and returns
the filter built.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the learnable weights used to linearly combine the basis filters</p></li>
<li><p><strong>points</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the points where the filter should be sampled</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the filter built</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.modules.basismanager.BlocksBasisSampler.compute_messages">
<span class="sig-name descname"><span class="pre">compute_messages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/basismanager/basissampler_blocks.html#BlocksBasisSampler.compute_messages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.modules.basismanager.BlocksBasisSampler.compute_messages" title="Permalink to this definition"></a></dt>
<dd><p>Expands the basis with the learnable weights to generate the filter and use it to compute the messages along the
edges.</p>
<p>Each point in <cite>points</cite> corresponds to an edge in a graph.
Each point is associated with a row of <cite>input</cite>.
This row is a feature associated to the source node of the edge which needs to be propagated to the target
node of the edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the messages computed</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="non-linearities">
<h2><a class="toc-backref" href="#contents">Non Linearities</a><a class="headerlink" href="#non-linearities" title="Permalink to this headline"></a></h2>
<section id="pointwisenonlinearity">
<h3><a class="toc-backref" href="#contents">PointwiseNonLinearity</a><a class="headerlink" href="#pointwisenonlinearity" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseNonLinearity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseNonLinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'p_relu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/pointwise.html#PointwiseNonLinearity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseNonLinearity" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Pointwise non-linearities.
The same scalar function is applied to every channel independently.
The input representation is preserved by this operation and, therefore, it equals the output representation.</p>
<p>Only representations supporting pointwise non-linearities are accepted as input field type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the identifier of the non-linearity.
It is used to specify which function to apply.
By default (<code class="docutils literal notranslate"><span class="pre">'p_relu'</span></code>), ReLU is used.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseNonLinearity.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/pointwise.html#PointwiseNonLinearity.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseNonLinearity.forward" title="Permalink to this definition"></a></dt>
<dd><p>Applies the pointwise activation function on the input fields</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map after the non-linearities have been applied</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="relu">
<h3><a class="toc-backref" href="#contents">ReLU</a><a class="headerlink" href="#relu" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.ReLU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ReLU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/relu.html#ReLU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.ReLU" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Module that implements a pointwise ReLU to every channel independently.
The input representation is preserved by this operation and, therefore, it equals the output
representation.</p>
<p>Only representations supporting pointwise non-linearities are accepted as input field type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – can optionally do the operation in-place. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.ReLU.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/relu.html#ReLU.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.ReLU.forward" title="Permalink to this definition"></a></dt>
<dd><p>Applies ReLU function on the input fields</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map after relu has been applied</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.ReLU.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/relu.html#ReLU.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.ReLU.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.ReLU.html#torch.nn.ReLU" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.ReLU</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="elu">
<h3><a class="toc-backref" href="#contents">ELU</a><a class="headerlink" href="#elu" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.ELU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ELU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/elu.html#ELU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.ELU" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Module that implements a pointwise ELU to every channel independently.
The input representation is preserved by this operation and, therefore, it equals the output
representation.</p>
<p>Only representations supporting pointwise non-linearities are accepted as input field type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – the <span class="math notranslate nohighlight">\(\alpha\)</span> value for the ELU formulation. Default: 1.0</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – can optionally do the operation in-place. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.ELU.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/elu.html#ELU.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.ELU.forward" title="Permalink to this definition"></a></dt>
<dd><p>Applies ELU function on the input fields</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map after elu has been applied</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.ELU.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/elu.html#ELU.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.ELU.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.ELU.html#torch.nn.ELU" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.ELU</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="fourierpointwise">
<h3><a class="toc-backref" href="#contents">FourierPointwise</a><a class="headerlink" href="#fourierpointwise" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.FourierPointwise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FourierPointwise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">grid_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'p_relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">grid_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/fourier.html#FourierPointwise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FourierPointwise" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Applies a Inverse Fourier Transform to sample the input features, apply the pointwise non-linearity in the
group domain (Dirac-delta basis) and, finally, computes the Fourier Transform to obtain irreps coefficients.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation is only <em>approximately</em> equivariant and its equivariance depends on the sampling grid and the
non-linear activation used, as well as the original band-limitation of the input features.</p>
</div>
<p>The same function is applied to every channel independently.
The input representation is preserved by this operation and, therefore, it equals the output representation.</p>
<p>The class first constructs a band-limited regular representation of <code class="docutils literal notranslate"><span class="pre">`gspace.fibergroup`</span></code> using
<a class="reference internal" href="escnn.group.html#escnn.group.Group.spectral_regular_representation" title="escnn.group.Group.spectral_regular_representation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.group.Group.spectral_regular_representation()</span></code></a>.
The band-limitation of this representation is specified by <code class="docutils literal notranslate"><span class="pre">`irreps`</span></code> which should be a list containing
a list of ids identifying irreps of <code class="docutils literal notranslate"><span class="pre">`gspace.fibergroup`</span></code> (see <code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.group.IrreducibleRepresentation.id</span></code>).
This representation is used to define the input and output field types, each containing <code class="docutils literal notranslate"><span class="pre">`channels`</span></code> copies
of a feature field transforming according to this representation.
A feature vector transforming according to such representation is interpreted as a vector of coefficients
parameterizing a function over the group using a band-limited Fourier basis.</p>
<p>To approximate the Fourier transform, this module uses a finite number of samples from the group.
The set of samples used is specified by the <code class="docutils literal notranslate"><span class="pre">`grid_args`</span></code> and <code class="docutils literal notranslate"><span class="pre">`grid_kwargs`</span></code> which are passed to the method
<a class="reference internal" href="escnn.group.html#escnn.group.Group.grid" title="escnn.group.Group.grid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">grid()</span></code></a>.</p>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>Mention the normalization of the transform we use</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gspace</strong> (<a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace" title="escnn.gspaces.GSpace"><em>GSpace</em></a>) – the gspace describing the symmetries of the data. The Fourier transform is
performed over the group <code class="docutils literal notranslate"><span class="pre">`gspace.fibergroup`</span></code></p></li>
<li><p><strong>channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of independent fields in the input <cite>FieldType</cite></p></li>
<li><p><strong>irreps</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of irreps’ ids to construct the band-limited representation</p></li>
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the identifier of the non-linearity.
It is used to specify which function to apply.
By default (<code class="docutils literal notranslate"><span class="pre">'p_relu'</span></code>), ReLU is used.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – applies the non-linear activation in-place. Default: <cite>True</cite></p></li>
<li><p><strong>*grid_args</strong> – parameters used to construct the discretization grid</p></li>
<li><p><strong>**grid_kwargs</strong> – keyword parameters used to construct the discretization grid</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FourierPointwise.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/fourier.html#FourierPointwise.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FourierPointwise.forward" title="Permalink to this definition"></a></dt>
<dd><p>Applies the pointwise activation function on the input fields</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map after the non-linearities have been applied</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="fourierelu">
<h3><a class="toc-backref" href="#contents">FourierELU</a><a class="headerlink" href="#fourierelu" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.FourierELU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FourierELU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">grid_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">grid_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/fourier.html#FourierELU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FourierELU" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.FourierPointwise" title="escnn.nn.modules.nonlinearities.fourier.FourierPointwise"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.nonlinearities.fourier.FourierPointwise</span></code></a></p>
<p>Applies a Inverse Fourier Transform to sample the input features, apply ELU point-wise in the
group domain (Dirac-delta basis) and, finally, computes the Fourier Transform to obtain irreps coefficients.
See <a class="reference internal" href="#escnn.nn.FourierPointwise" title="escnn.nn.FourierPointwise"><code class="xref py py-class docutils literal notranslate"><span class="pre">FourierPointwise</span></code></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gspace</strong> (<a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace" title="escnn.gspaces.GSpace"><em>GSpace</em></a>) – the gspace describing the symmetries of the data. The Fourier transform is
performed over the group <code class="docutils literal notranslate"><span class="pre">`gspace.fibergroup`</span></code></p></li>
<li><p><strong>channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of independent fields in the input <cite>FieldType</cite></p></li>
<li><p><strong>irreps</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of irreps’ ids to construct the band-limited representation</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – applies the non-linear activation in-place. Default: <cite>True</cite></p></li>
<li><p><strong>*grid_args</strong> – parameters used to construct the discretization grid</p></li>
<li><p><strong>**grid_kwargs</strong> – keyword parameters used to construct the discretization grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="quotientfourierpointwise">
<h3><a class="toc-backref" href="#contents">QuotientFourierPointwise</a><a class="headerlink" href="#quotientfourierpointwise" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.QuotientFourierPointwise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QuotientFourierPointwise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subgroup_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">grid_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'p_relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">grid_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/fourier_quotient.html#QuotientFourierPointwise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.QuotientFourierPointwise" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Applies a Inverse Fourier Transform to sample the input features on a <em>quotient space</em> <span class="math notranslate nohighlight">\(X\)</span>, apply the
pointwise non-linearity in the spatial domain (Dirac-delta basis) and, finally, computes the Fourier Transform
to obtain irreps coefficients.
The quotient space used is isomorphic to <span class="math notranslate nohighlight">\(X \cong G / H\)</span> where <span class="math notranslate nohighlight">\(G\)</span> is <code class="docutils literal notranslate"><span class="pre">`gspace.fibergroup`</span></code> while
<span class="math notranslate nohighlight">\(H\)</span> is the subgroup of <span class="math notranslate nohighlight">\(G\)</span> idenitified by <code class="docutils literal notranslate"><span class="pre">`subgroup_id`</span></code>; see
<a class="reference internal" href="escnn.group.html#escnn.group.Group.subgroup" title="escnn.group.Group.subgroup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subgroup()</span></code></a> and <a class="reference internal" href="escnn.group.html#escnn.group.Group.homspace" title="escnn.group.Group.homspace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">homspace()</span></code></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation is only <em>approximately</em> equivariant and its equivariance depends on the sampling grid and the
non-linear activation used, as well as the original band-limitation of the input features.</p>
</div>
<p>The same function is applied to every channel independently.
The input representation is preserved by this operation and, therefore, it equals the output representation.</p>
<p>The class first constructs a band-limited quotient representation of <code class="docutils literal notranslate"><span class="pre">`gspace.fibergroup`</span></code> using
<a class="reference internal" href="escnn.group.html#escnn.group.Group.spectral_quotient_representation" title="escnn.group.Group.spectral_quotient_representation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.group.Group.spectral_quotient_representation()</span></code></a>.
The band-limitation of this representation is specified by <code class="docutils literal notranslate"><span class="pre">`irreps`</span></code> which should be a list containing
a list of ids identifying irreps of <code class="docutils literal notranslate"><span class="pre">`gspace.fibergroup`</span></code> (see <code class="xref py py-attr docutils literal notranslate"><span class="pre">escnn.group.IrreducibleRepresentation.id</span></code>).
This representation is used to define the input and output field types, each containing <code class="docutils literal notranslate"><span class="pre">`channels`</span></code> copies
of a feature field transforming according to this representation.
A feature vector transforming according to such representation is interpreted as a vector of coefficients
parameterizing a function over the group using a band-limited Fourier basis.</p>
<p>To approximate the Fourier transform, this module uses a finite number of samples from the group.
The set of samples to be used can be specified through the parameter <code class="docutils literal notranslate"><span class="pre">`grid`</span></code> or by the <code class="docutils literal notranslate"><span class="pre">`grid_args`</span></code> and
<code class="docutils literal notranslate"><span class="pre">`grid_kwargs`</span></code> which will then be passed to the method <a class="reference internal" href="escnn.group.html#escnn.group.Group.grid" title="escnn.group.Group.grid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">grid()</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>By definition, an homogeneous space is invariant under a right action of the subgroup <span class="math notranslate nohighlight">\(H\)</span>.
That means that a feature representing a function over a homogeneous space <span class="math notranslate nohighlight">\(X \cong G/H\)</span>, when
interpreted as a function over <span class="math notranslate nohighlight">\(G\)</span> (as we do here when sampling), the function will be constant along
each coset, i.e. <span class="math notranslate nohighlight">\(f(gh) = f(g)\)</span> if <span class="math notranslate nohighlight">\(g \in G, h\in H\)</span>.
An approximately uniform sampling grid over <span class="math notranslate nohighlight">\(G\)</span> creates an approximately uniform grid over <span class="math notranslate nohighlight">\(G/H\)</span>
through projection but might contain redundant elements (if the grid contains <span class="math notranslate nohighlight">\(g 'in G\)</span>, any element
<span class="math notranslate nohighlight">\(gh\)</span> in the grid will be redundant).
It is therefore advised to create a grid directly in the quotient space, e.g. using
<a class="reference internal" href="escnn.group.html#escnn.group.SO3.sphere_grid" title="escnn.group.SO3.sphere_grid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.group.SO3.sphere_grid()</span></code></a>, <a class="reference internal" href="escnn.group.html#escnn.group.O3.sphere_grid" title="escnn.group.O3.sphere_grid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.group.O3.sphere_grid()</span></code></a>.
We do not support yet a general method and interface to generate grids over any homogeneous space for any
group, so you should check each group’s methods.</p>
</div>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p>Mention the normalization of the transform we use</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gspace</strong> (<a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace" title="escnn.gspaces.GSpace"><em>GSpace</em></a>) – the gspace describing the symmetries of the data. The Fourier transform is
performed over the group <code class="docutils literal notranslate"><span class="pre">`gspace.fibergroup`</span></code></p></li>
<li><p><strong>subgroup_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – identifier of the subgroup <span class="math notranslate nohighlight">\(H\)</span> to construct the quotient space</p></li>
<li><p><strong>channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of independent fields in the input <cite>FieldType</cite></p></li>
<li><p><strong>irreps</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of irreps’ ids to construct the band-limited representation</p></li>
<li><p><strong>*grid_args</strong> – parameters used to construct the discretization grid</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – list containing the elements of the group to use for sampling. Optional (default <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the identifier of the non-linearity.
It is used to specify which function to apply.
By default (<code class="docutils literal notranslate"><span class="pre">'p_relu'</span></code>), ReLU is used.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – applies the non-linear activation in-place. Default: <cite>True</cite></p></li>
<li><p><strong>**grid_kwargs</strong> – keyword parameters used to construct the discretization grid</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.QuotientFourierPointwise.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/fourier_quotient.html#QuotientFourierPointwise.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.QuotientFourierPointwise.forward" title="Permalink to this definition"></a></dt>
<dd><p>Applies the pointwise activation function on the input fields</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map after the non-linearities have been applied</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="quotientfourierelu">
<h3><a class="toc-backref" href="#contents">QuotientFourierELU</a><a class="headerlink" href="#quotientfourierelu" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.QuotientFourierELU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QuotientFourierELU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subgroup_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">grid_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">grid_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/fourier_quotient.html#QuotientFourierELU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.QuotientFourierELU" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.QuotientFourierPointwise" title="escnn.nn.modules.nonlinearities.fourier_quotient.QuotientFourierPointwise"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.nonlinearities.fourier_quotient.QuotientFourierPointwise</span></code></a></p>
<p>Applies a Inverse Fourier Transform to sample the input features on a quotient space, apply ELU point-wise
in the spatial domain (Dirac-delta basis) and, finally, computes the Fourier Transform to obtain irreps
coefficients. See <a class="reference internal" href="#escnn.nn.QuotientFourierPointwise" title="escnn.nn.QuotientFourierPointwise"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuotientFourierPointwise</span></code></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gspace</strong> (<a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace" title="escnn.gspaces.GSpace"><em>GSpace</em></a>) – the gspace describing the symmetries of the data. The Fourier transform is
performed over the group <code class="docutils literal notranslate"><span class="pre">`gspace.fibergroup`</span></code></p></li>
<li><p><strong>subgroup_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – identifier of the subgroup <span class="math notranslate nohighlight">\(H\)</span> to construct the quotient space</p></li>
<li><p><strong>channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of independent fields in the input <cite>FieldType</cite></p></li>
<li><p><strong>irreps</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of irreps’ ids to construct the band-limited representation</p></li>
<li><p><strong>*grid_args</strong> – parameters used to construct the discretization grid</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – list containing the elements of the group to use for sampling. Optional (default <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – applies the non-linear activation in-place. Default: <cite>True</cite></p></li>
<li><p><strong>**grid_kwargs</strong> – keyword parameters used to construct the discretization grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="gatednonlinearity1">
<h3><a class="toc-backref" href="#contents">GatedNonLinearity1</a><a class="headerlink" href="#gatednonlinearity1" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.GatedNonLinearity1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GatedNonLinearity1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/gated1.html#GatedNonLinearity1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GatedNonLinearity1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Gated non-linearities.
This module applies a bias and a sigmoid function of the gates fields and, then, multiplies each gated
field by one of the gates.</p>
<p>The input representation of the gated fields is preserved by this operation while the gate fields are
discarded.</p>
<p>The gates and the gated fields are provided in one unique input tensor and, therefore, <code class="xref py py-attr docutils literal notranslate"><span class="pre">in_repr</span></code> should
be the representation of the fiber containing both gates and gated fields.
Moreover, the parameter <code class="xref py py-attr docutils literal notranslate"><span class="pre">gates</span></code> needs to be set with a list long as the total number of fields,
containing in a position <code class="docutils literal notranslate"><span class="pre">i</span></code> the string <code class="docutils literal notranslate"><span class="pre">&quot;gate&quot;</span></code> if the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th field is a gate or the string <code class="docutils literal notranslate"><span class="pre">&quot;gated&quot;</span></code>
if the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th field is a gated field. No other strings are allowed.
By default (<code class="docutils literal notranslate"><span class="pre">gates</span> <span class="pre">=</span> <span class="pre">None</span></code>), the first half of the fields is assumed to contain the gates (and, so, these
fields have to be trivial fields) while the second one is assumed to contain the gated fields.</p>
<p>In any case, the number of gates and the number of gated fields have to match (therefore, the number of
fields has to be an even number).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>gates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – list of strings specifying which field in input is a gate and which is a gated field</p></li>
<li><p><strong>drop_gates</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), drop the trivial fields after using them to compute
the gates. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the gates are stacked with the gated fields in the output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GatedNonLinearity1.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/gated1.html#GatedNonLinearity1.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GatedNonLinearity1.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply the gated non-linearity to the input feature map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="gatednonlinearity2">
<h3><a class="toc-backref" href="#contents">GatedNonLinearity2</a><a class="headerlink" href="#gatednonlinearity2" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.GatedNonLinearity2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GatedNonLinearity2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/gated2.html#GatedNonLinearity2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GatedNonLinearity2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Gated non-linearities.
This module applies a bias and a sigmoid function of the gates fields and, then, multiplies each gated
field by one of the gates.</p>
<p>The input representation of the gated fields is preserved by this operation while the gate fields are
discarded.</p>
<p>The gates and the gated fields are provided in two different tensors: <code class="xref py py-attr docutils literal notranslate"><span class="pre">in_repr</span></code> is a tuple containing two
representations: the representation of the tensor containing only the gates (which have to be trivial fields)
and the representation of the tensor containing only the gated fields. Therefore, two tensors need to be
provided as input to the <code class="docutils literal notranslate"><span class="pre">forward</span></code> method: the first contains the gates and the second the gated fields.
Finally, notice that the number of gates and the number of gated fields have to match, i.e. the two
representations need to have the same number of fields.</p>
<div class="admonition-todo admonition" id="id6">
<p class="admonition-title">Todo</p>
<p>This module has 2 input tensors and, so, two input field types.
EquivariantModule only supports one input though.
Fix this.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>in_type</strong> (<em>Tuple</em>) – a pair containing, in order, the field type of the gates and the field type
of the gated fields</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GatedNonLinearity2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/gated2.html#GatedNonLinearity2.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GatedNonLinearity2.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply the gated non-linearity to the input feature map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gates</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – feature map corresponding to the gates</p></li>
<li><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – input feature map corresponding to the gated fields</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="inducedgatednonlinearity1">
<h3><a class="toc-backref" href="#contents">InducedGatedNonLinearity1</a><a class="headerlink" href="#inducedgatednonlinearity1" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.InducedGatedNonLinearity1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InducedGatedNonLinearity1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/induced_gated1.html#InducedGatedNonLinearity1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InducedGatedNonLinearity1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Induced Gated non-linearities.</p>
<div class="admonition-todo admonition" id="id7">
<p class="admonition-title">Todo</p>
<p>complete documentation!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure all induced gate and gates have same subgroup</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>gates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – list of strings specifying which field in input is a gate and which is a gated field</p></li>
<li><p><strong>drop_gates</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), drop the trivial fields after using them to compute
the gates. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the gates are stacked with the gated fields in the output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.InducedGatedNonLinearity1.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/induced_gated1.html#InducedGatedNonLinearity1.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InducedGatedNonLinearity1.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply the gated non-linearity to the input feature map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="concatenatednonlinearity">
<h3><a class="toc-backref" href="#contents">ConcatenatedNonLinearity</a><a class="headerlink" href="#concatenatednonlinearity" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.ConcatenatedNonLinearity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConcatenatedNonLinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c_relu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/concatenated.html#ConcatenatedNonLinearity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.ConcatenatedNonLinearity" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Concatenated non-linearities.
For each input channel, the module applies the specified activation function both to its value and its opposite
(the value multiplied by -1).
The number of channels is, therefore, doubled.</p>
<p>Notice that not all the representations support this kind of non-linearity. Indeed, only representations
with the same pattern of permutation matrices and containing only values in <span class="math notranslate nohighlight">\(\{0, 1, -1\}\)</span> support it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the identifier of the non-linearity. It is used to specify which function to apply.
By default (<code class="docutils literal notranslate"><span class="pre">'c_relu'</span></code>), ReLU is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="normnonlinearity">
<h3><a class="toc-backref" href="#contents">NormNonLinearity</a><a class="headerlink" href="#normnonlinearity" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.NormNonLinearity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NormNonLinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n_relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/norm.html#NormNonLinearity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.NormNonLinearity" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Norm non-linearities.
This module applies a bias and an activation function over the norm of each field.</p>
<p>The input representation of the fields is preserved by this operation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If ‘squash’ non-linearity (<cite>function</cite>) is chosen, no bias is allowed</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the identifier of the non-linearity. It is used to specify which function to
apply. By default (<code class="docutils literal notranslate"><span class="pre">'n_relu'</span></code>), ReLU is used.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – add bias to norm of fields before computing the non-linearity. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.NormNonLinearity.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/norm.html#NormNonLinearity.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.NormNonLinearity.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply norm non-linearities to the input feature map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="inducednormnonlinearity">
<h3><a class="toc-backref" href="#contents">InducedNormNonLinearity</a><a class="headerlink" href="#inducednormnonlinearity" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.InducedNormNonLinearity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InducedNormNonLinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n_relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/induced_norm.html#InducedNormNonLinearity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InducedNormNonLinearity" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Induced Norm non-linearities.
This module requires the input fields to be associated to an induced representation from a representation
which supports ‘norm’ non-linearities.
This module applies a bias and an activation function over the norm of each sub-field of an induced field.
The bias is shared among all sub-field of the same induced field.</p>
<p>The input representation of the fields is preserved by this operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the identifier of the non-linearity. It is used to specify which function to
apply. By default (<code class="docutils literal notranslate"><span class="pre">'n_relu'</span></code>), ReLU is used.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – add bias to norm of fields before computing the non-linearity. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.InducedNormNonLinearity.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/induced_norm.html#InducedNormNonLinearity.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InducedNormNonLinearity.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply norm non-linearities to the input feature map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="vectorfieldnonlinearity">
<h3><a class="toc-backref" href="#contents">VectorFieldNonLinearity</a><a class="headerlink" href="#vectorfieldnonlinearity" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.VectorFieldNonLinearity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">VectorFieldNonLinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/vectorfield.html#VectorFieldNonLinearity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.VectorFieldNonLinearity" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>VectorField non-linearities.
This non-linearity only supports the regular representation of cyclic group <span class="math notranslate nohighlight">\(C_N\)</span>, i.e. the group of
<span class="math notranslate nohighlight">\(N\)</span> discrete rotations.
For each input field, the output one is built by taking the rotation associated with the highest
activation; then, a 2-dimensional vector with an angle with respect to the x-axis equal to that rotation and a
length equal to its activation is set in the output field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.VectorFieldNonLinearity.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/nonlinearities/vectorfield.html#VectorFieldNonLinearity.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.VectorFieldNonLinearity.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply the VectorField non-linearity to the input feature map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="invariant-maps">
<h2><a class="toc-backref" href="#contents">Invariant Maps</a><a class="headerlink" href="#invariant-maps" title="Permalink to this headline"></a></h2>
<section id="grouppooling">
<h3><a class="toc-backref" href="#contents">GroupPooling</a><a class="headerlink" href="#grouppooling" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.GroupPooling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GroupPooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/invariantmaps/gpool.html#GroupPooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GroupPooling" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Module that implements <em>group pooling</em>.
This module only supports permutation representations such as regular representation,
quotient representation or trivial representation (though, in the last case, this module
acts as identity).
For each input field, an output field is built by taking the maximum activation within that field; as a result,
the output field transforms according to a trivial representation.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="escnn.group.html#escnn.group.Group.regular_representation" title="escnn.group.Group.regular_representation"><code class="xref py py-attr docutils literal notranslate"><span class="pre">regular_representation</span></code></a>,
<a class="reference internal" href="escnn.group.html#escnn.group.Group.quotient_representation" title="escnn.group.Group.quotient_representation"><code class="xref py py-attr docutils literal notranslate"><span class="pre">quotient_representation</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GroupPooling.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/invariantmaps/gpool.html#GroupPooling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GroupPooling.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply Group Pooling to the input feature map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GroupPooling.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/invariantmaps/gpool.html#GroupPooling.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GroupPooling.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to the pure PyTorch module <a class="reference internal" href="escnn.nn.others.html#escnn.nn.MaxPoolChannels" title="escnn.nn.MaxPoolChannels"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaxPoolChannels</span></code></a>
and set to “eval” mode.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently, this method only supports group pooling with feature types containing only representations
of the same size.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because there is no native PyTorch module performing this operation, it is not possible to export this
module without any dependency with this library.
Indeed, the resulting module is dependent on this library through the class
<a class="reference internal" href="escnn.nn.others.html#escnn.nn.MaxPoolChannels" title="escnn.nn.MaxPoolChannels"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaxPoolChannels</span></code></a>.
In case PyTorch will introduce a similar module in a future release, we will update this method to remove
this dependency.</p>
<p>Nevertheless, the <a class="reference internal" href="escnn.nn.others.html#escnn.nn.MaxPoolChannels" title="escnn.nn.MaxPoolChannels"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaxPoolChannels</span></code></a> module is slightly lighter
than <a class="reference internal" href="#escnn.nn.GroupPooling" title="escnn.nn.GroupPooling"><code class="xref py py-class docutils literal notranslate"><span class="pre">GroupPooling</span></code></a> as it does not perform any automatic type checking and does not wrap
each tensor in a <a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTensor</span></code></a>.
Furthermore, the <a class="reference internal" href="escnn.nn.others.html#escnn.nn.MaxPoolChannels" title="escnn.nn.MaxPoolChannels"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaxPoolChannels</span></code></a> class is very simple and
one can easily reimplement it to remove any dependency with this library after training the model.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="normpool">
<h3><a class="toc-backref" href="#contents">NormPool</a><a class="headerlink" href="#normpool" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.NormPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NormPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/invariantmaps/norm.html#NormPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.NormPool" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Module that implements Norm Pooling.
For each input field, an output one is built by taking the norm of that field; as a result, the output
field transforms according to a trivial representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.NormPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/invariantmaps/norm.html#NormPool.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.NormPool.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply the Norm Pooling to the input feature map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="inducednormpool">
<h3><a class="toc-backref" href="#contents">InducedNormPool</a><a class="headerlink" href="#inducednormpool" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.InducedNormPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InducedNormPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/invariantmaps/induced_norm.html#InducedNormPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InducedNormPool" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Module that implements Induced Norm Pooling.
This module requires the input fields to be associated to an induced representation from a representation
which supports ‘norm’ non-linearities.</p>
<p>First, for each input field, an output one is built by taking the maximum norm of all its sub-fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.InducedNormPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/invariantmaps/induced_norm.html#InducedNormPool.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InducedNormPool.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply the Norm Pooling to the input feature map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="pooling">
<h2><a class="toc-backref" href="#contents">Pooling</a><a class="headerlink" href="#pooling" title="Permalink to this headline"></a></h2>
<section id="normmaxpool">
<h3><a class="toc-backref" href="#contents">NormMaxPool</a><a class="headerlink" href="#normmaxpool" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.NormMaxPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NormMaxPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ceil_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/norm_max.html#NormMaxPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.NormMaxPool" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Max-pooling based on the fields’ norms. In a given window of shape <code class="xref py py-attr docutils literal notranslate"><span class="pre">kernel_size</span></code>, for each
group of channels belonging to the same field, the field with the highest norm (as the length of the vector)
is preserved.</p>
<p>Except <code class="xref py py-attr docutils literal notranslate"><span class="pre">in_type</span></code>, the other parameters correspond to the ones of <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.MaxPool2d.html#torch.nn.MaxPool2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.MaxPool2d</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – the size of the window to take a max over</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – the stride of the window. Default value is <code class="xref py py-attr docutils literal notranslate"><span class="pre">kernel_size</span></code></p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – implicit zero padding to be added on both sides</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – a parameter that controls the stride of elements in the window</p></li>
<li><p><strong>ceil_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – when <code class="docutils literal notranslate"><span class="pre">True</span></code>, will use ceil instead of floor to compute the output shape</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.NormMaxPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/norm_max.html#NormMaxPool.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.NormMaxPool.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run the norm-based max-pooling on the input tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="pointwisemaxpool">
<h3><a class="toc-backref" href="#contents">PointwiseMaxPool</a><a class="headerlink" href="#pointwisemaxpool" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseMaxPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseMaxPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ceil_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_max.html#PointwiseMaxPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseMaxPool" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Channel-wise max-pooling: each channel is treated independently.
This module works exactly as <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.MaxPool2D</span></code>, wrapping it in the
<a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> interface.</p>
<p>Notice that not all representations support this kind of pooling. In general, only representations which support
pointwise non-linearities do.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – the size of the window to take a max over</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – the stride of the window. Default value is <code class="xref py py-attr docutils literal notranslate"><span class="pre">kernel_size</span></code></p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – implicit zero padding to be added on both sides</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – a parameter that controls the stride of elements in the window</p></li>
<li><p><strong>ceil_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – when True, will use ceil instead of floor to compute the output shape</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseMaxPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_max.html#PointwiseMaxPool.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseMaxPool.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseMaxPool.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_max.html#PointwiseMaxPool.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseMaxPool.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.MaxPool2d.html#torch.nn.MaxPool2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.MaxPool2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="pointwisemaxpoolantialiased">
<h3><a class="toc-backref" href="#contents">PointwiseMaxPoolAntialiased</a><a class="headerlink" href="#pointwisemaxpoolantialiased" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseMaxPoolAntialiased">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseMaxPoolAntialiased</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ceil_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_max.html#PointwiseMaxPoolAntialiased"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseMaxPoolAntialiased" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.PointwiseMaxPool" title="escnn.nn.modules.pooling.pointwise_max.PointwiseMaxPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.pooling.pointwise_max.PointwiseMaxPool</span></code></a></p>
<p>Anti-aliased version of channel-wise max-pooling (each channel is treated independently).</p>
<p>The max over a neighborhood is performed pointwise withot downsampling.
Then, convolution with a gaussian blurring filter is performed before downsampling the feature map.</p>
<p>Based on <a class="reference external" href="https://arxiv.org/abs/1904.11486">Making Convolutional Networks Shift-Invariant Again</a>.</p>
<p>Notice that not all representations support this kind of pooling. In general, only representations which support
pointwise non-linearities do.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – the size of the window to take a max over</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – the stride of the window. Default value is <code class="xref py py-attr docutils literal notranslate"><span class="pre">kernel_size</span></code></p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – implicit zero padding to be added on both sides</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – a parameter that controls the stride of elements in the window</p></li>
<li><p><strong>ceil_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – when <code class="docutils literal notranslate"><span class="pre">True</span></code>, will use ceil instead of floor to compute the output shape</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – standard deviation for the Gaussian blur filter</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseMaxPoolAntialiased.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_max.html#PointwiseMaxPoolAntialiased.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseMaxPoolAntialiased.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="pointwiseavgpool">
<h3><a class="toc-backref" href="#contents">PointwiseAvgPool</a><a class="headerlink" href="#pointwiseavgpool" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAvgPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseAvgPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ceil_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_avg.html#PointwiseAvgPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAvgPool" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Channel-wise average-pooling: each channel is treated independently.
This module works exactly as <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.AvgPool2D</span></code>, wrapping it in the
<a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> interface.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – the size of the window to take a average over</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – the stride of the window. Default value is <code class="xref py py-attr docutils literal notranslate"><span class="pre">kernel_size</span></code></p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – implicit zero padding to be added on both sides</p></li>
<li><p><strong>ceil_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – when <code class="docutils literal notranslate"><span class="pre">True</span></code>, will use ceil instead of floor to compute the output shape</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAvgPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_avg.html#PointwiseAvgPool.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAvgPool.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="pointwiseavgpoolantialiased">
<h3><a class="toc-backref" href="#contents">PointwiseAvgPoolAntialiased</a><a class="headerlink" href="#pointwiseavgpoolantialiased" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAvgPoolAntialiased">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseAvgPoolAntialiased</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_avg.html#PointwiseAvgPoolAntialiased"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAvgPoolAntialiased" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Antialiased channel-wise average-pooling: each channel is treated independently.
It performs strided convolution with a Gaussian blur filter.</p>
<p>The size of the filter is computed as 3 standard deviations of the Gaussian curve.
By default, padding is added such that input size is preserved if stride is 1.</p>
<p>Based on <a class="reference external" href="https://arxiv.org/abs/1904.11486">Making Convolutional Networks Shift-Invariant Again</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – standard deviation for the Gaussian blur filter</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – the stride of the window.</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – additional zero padding to be added on both sides</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAvgPoolAntialiased.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_avg.html#PointwiseAvgPoolAntialiased.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAvgPoolAntialiased.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="pointwiseavgpool3d">
<h3><a class="toc-backref" href="#contents">PointwiseAvgPool3D</a><a class="headerlink" href="#pointwiseavgpool3d" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAvgPool3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseAvgPool3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ceil_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_avg_3d.html#PointwiseAvgPool3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAvgPool3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Channel-wise average-pooling: each channel is treated independently.
This module works exactly as <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.AvgPool3D</span></code>, wrapping it in the
<a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> interface.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – the size of the window to take a average over</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – the stride of the window. Default value is <code class="xref py py-attr docutils literal notranslate"><span class="pre">kernel_size</span></code></p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – implicit zero padding to be added on both sides</p></li>
<li><p><strong>ceil_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – when <code class="docutils literal notranslate"><span class="pre">True</span></code>, will use ceil instead of floor to compute the output shape</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAvgPool3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_avg_3d.html#PointwiseAvgPool3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAvgPool3D.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="pointwiseavgpoolantialiased3d">
<h3><a class="toc-backref" href="#contents">PointwiseAvgPoolAntialiased3D</a><a class="headerlink" href="#pointwiseavgpoolantialiased3d" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAvgPoolAntialiased3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseAvgPoolAntialiased3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_avg_3d.html#PointwiseAvgPoolAntialiased3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAvgPoolAntialiased3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Antialiased channel-wise average-pooling: each channel is treated independently.
It performs strided convolution with a Gaussian blur filter.</p>
<p>The size of the filter is computed as 3 standard deviations of the Gaussian curve.
By default, padding is added such that input size is preserved if stride is 1.</p>
<p>Inspired by <a class="reference external" href="https://arxiv.org/abs/1904.11486">Making Convolutional Networks Shift-Invariant Again</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – standard deviation for the Gaussian blur filter</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – the stride of the window.</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – additional zero padding to be added on both sides</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAvgPoolAntialiased3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_avg_3d.html#PointwiseAvgPoolAntialiased3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAvgPoolAntialiased3D.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="pointwiseadaptiveavgpool">
<h3><a class="toc-backref" href="#contents">PointwiseAdaptiveAvgPool</a><a class="headerlink" href="#pointwiseadaptiveavgpool" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAdaptiveAvgPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseAdaptiveAvgPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_adaptive_avg.html#PointwiseAdaptiveAvgPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAdaptiveAvgPool" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Adaptive channel-wise average-pooling: each channel is treated independently.
This module works exactly as <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.AdaptiveAvgPool2D</span></code>, wrapping it in
the <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> interface.</p>
<p>Notice that not all representations support this kind of pooling. In general, only representations which support
pointwise non-linearities do.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – the target output size of the image of the form H x W</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAdaptiveAvgPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_adaptive_avg.html#PointwiseAdaptiveAvgPool.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAdaptiveAvgPool.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAdaptiveAvgPool.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_adaptive_avg.html#PointwiseAdaptiveAvgPool.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAdaptiveAvgPool.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.AdaptiveAvgPool2d.html#torch.nn.AdaptiveAvgPool2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.AdaptiveAvgPool2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="pointwiseadaptivemaxpool">
<h3><a class="toc-backref" href="#contents">PointwiseAdaptiveMaxPool</a><a class="headerlink" href="#pointwiseadaptivemaxpool" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAdaptiveMaxPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseAdaptiveMaxPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_adaptive_max.html#PointwiseAdaptiveMaxPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAdaptiveMaxPool" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Module that implements adaptive channel-wise max-pooling: each channel is treated independently.
This module works exactly as <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.AdaptiveMaxPool2D</span></code>, wrapping it in the
<a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> interface.</p>
<p>Notice that not all representations support this kind of pooling. In general, only representations which support
pointwise non-linearities do.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) – the target output size of the image of the form H x W</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAdaptiveMaxPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_adaptive_max.html#PointwiseAdaptiveMaxPool.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAdaptiveMaxPool.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseAdaptiveMaxPool.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/pooling/pointwise_adaptive_max.html#PointwiseAdaptiveMaxPool.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseAdaptiveMaxPool.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.AdaptiveAvgPool2d.html#torch.nn.AdaptiveAvgPool2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.AdaptiveAvgPool2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="normalization">
<h2><a class="toc-backref" href="#contents">Normalization</a><a class="headerlink" href="#normalization" title="Permalink to this headline"></a></h2>
<section id="iidbatchnorm1d">
<h3><a class="toc-backref" href="#contents">IIDBatchNorm1d</a><a class="headerlink" href="#iidbatchnorm1d" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.IIDBatchNorm1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IIDBatchNorm1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/iid.html#IIDBatchNorm1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.IIDBatchNorm1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.batchnormalization.iid._IIDBatchNorm</span></code></p>
<p>Batch normalization for generic representations for 1D or 0D data (i.e. 3D or 2D inputs).</p>
<p>This batch normalization assumes that all dimensions within the same field have the same variance, i.e. that
the covariance matrix of each field in <cite>in_type</cite> is a scalar multiple of the identity.
Moreover, the mean is only computed over the trivial irreps occourring in the input representations (the input
representation does not need to be decomposed into a direct sum of irreps since this module can deal with the
change of basis).</p>
<p>Similarly, if <cite>affine = True</cite>, a single scale is learnt per input field and the bias is applied only to the
trivial irreps.</p>
<p>This assumption is equivalent to the usual Batch Normalization in a Group Convolution NN (GCNN), where
statistics are shared over the group dimension.
See Chapter 4.2 at <a class="reference external" href="https://gabri95.github.io/Thesis/thesis.pdf">https://gabri95.github.io/Thesis/thesis.pdf</a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – a value added to the denominator for numerical stability. Default: <code class="docutils literal notranslate"><span class="pre">1e-5</span></code></p></li>
<li><p><strong>momentum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – the value used for the <code class="docutils literal notranslate"><span class="pre">running_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">running_var</span></code> computation.
Can be set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for cumulative moving average (i.e. simple average). Default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></li>
<li><p><strong>affine</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, this module has learnable affine parameters. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>track_running_stats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the module tracks the running mean and variance;
when set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, it does not track such statistics but uses
batch statistics in both training and eval modes.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.IIDBatchNorm1d.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/iid.html#IIDBatchNorm1d.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.IIDBatchNorm1d.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.BatchNorm2d.html#torch.nn.BatchNorm2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.BatchNorm2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="iidbatchnorm2d">
<h3><a class="toc-backref" href="#contents">IIDBatchNorm2d</a><a class="headerlink" href="#iidbatchnorm2d" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.IIDBatchNorm2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IIDBatchNorm2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/iid.html#IIDBatchNorm2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.IIDBatchNorm2d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.batchnormalization.iid._IIDBatchNorm</span></code></p>
<p>Batch normalization for generic representations for 2D data (i.e. 4D inputs).</p>
<p>This batch normalization assumes that all dimensions within the same field have the same variance, i.e. that
the covariance matrix of each field in <cite>in_type</cite> is a scalar multiple of the identity.
Moreover, the mean is only computed over the trivial irreps occourring in the input representations (the input
representation does not need to be decomposed into a direct sum of irreps since this module can deal with the
change of basis).</p>
<p>Similarly, if <cite>affine = True</cite>, a single scale is learnt per input field and the bias is applied only to the
trivial irreps.</p>
<p>This assumption is equivalent to the usual Batch Normalization in a Group Convolution NN (GCNN), where
statistics are shared over the group dimension.
See Chapter 4.2 at <a class="reference external" href="https://gabri95.github.io/Thesis/thesis.pdf">https://gabri95.github.io/Thesis/thesis.pdf</a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – a value added to the denominator for numerical stability. Default: <code class="docutils literal notranslate"><span class="pre">1e-5</span></code></p></li>
<li><p><strong>momentum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – the value used for the <code class="docutils literal notranslate"><span class="pre">running_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">running_var</span></code> computation.
Can be set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for cumulative moving average (i.e. simple average). Default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></li>
<li><p><strong>affine</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, this module has learnable affine parameters. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>track_running_stats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the module tracks the running mean and variance;
when set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, it does not track such statistics but uses
batch statistics in both training and eval modes.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.IIDBatchNorm2d.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/iid.html#IIDBatchNorm2d.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.IIDBatchNorm2d.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.BatchNorm2d.html#torch.nn.BatchNorm2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.BatchNorm2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="iidbatchnorm3d">
<h3><a class="toc-backref" href="#contents">IIDBatchNorm3d</a><a class="headerlink" href="#iidbatchnorm3d" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.IIDBatchNorm3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IIDBatchNorm3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/iid.html#IIDBatchNorm3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.IIDBatchNorm3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.batchnormalization.iid._IIDBatchNorm</span></code></p>
<p>Batch normalization for generic representations for 3D data (i.e. 5D inputs).</p>
<p>This batch normalization assumes that all dimensions within the same field have the same variance, i.e. that
the covariance matrix of each field in <cite>in_type</cite> is a scalar multiple of the identity.
Moreover, the mean is only computed over the trivial irreps occourring in the input representations (the input
representation does not need to be decomposed into a direct sum of irreps since this module can deal with the
change of basis).</p>
<p>Similarly, if <cite>affine = True</cite>, a single scale is learnt per input field and the bias is applied only to the
trivial irreps.</p>
<p>This assumption is equivalent to the usual Batch Normalization in a Group Convolution NN (GCNN), where
statistics are shared over the group dimension.
See Chapter 4.2 at <a class="reference external" href="https://gabri95.github.io/Thesis/thesis.pdf">https://gabri95.github.io/Thesis/thesis.pdf</a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – a value added to the denominator for numerical stability. Default: <code class="docutils literal notranslate"><span class="pre">1e-5</span></code></p></li>
<li><p><strong>momentum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – the value used for the <code class="docutils literal notranslate"><span class="pre">running_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">running_var</span></code> computation.
Can be set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for cumulative moving average (i.e. simple average). Default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></li>
<li><p><strong>affine</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, this module has learnable affine parameters. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>track_running_stats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the module tracks the running mean and variance;
when set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, it does not track such statistics but uses
batch statistics in both training and eval modes.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.IIDBatchNorm3d.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/iid.html#IIDBatchNorm3d.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.IIDBatchNorm3d.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.BatchNorm2d.html#torch.nn.BatchNorm2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.BatchNorm2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="innerbatchnorm">
<h3><a class="toc-backref" href="#contents">InnerBatchNorm</a><a class="headerlink" href="#innerbatchnorm" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.InnerBatchNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InnerBatchNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/inner.html#InnerBatchNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InnerBatchNorm" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Batch normalization for representations with permutation matrices.</p>
<p>Statistics are computed both over the batch and the spatial dimensions and over the channels within
the same field (which are permuted by the representation).</p>
<p>Only representations supporting pointwise non-linearities are accepted as input field type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – a value added to the denominator for numerical stability. Default: <code class="docutils literal notranslate"><span class="pre">1e-5</span></code></p></li>
<li><p><strong>momentum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – the value used for the <code class="docutils literal notranslate"><span class="pre">running_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">running_var</span></code> computation.
Can be set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for cumulative moving average (i.e. simple average). Default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></li>
<li><p><strong>affine</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, this module has learnable affine parameters. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>track_running_stats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the module tracks the running mean and variance;
when set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, it does not track such statistics but uses
batch statistics in both training and eval modes.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.InnerBatchNorm.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/inner.html#InnerBatchNorm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InnerBatchNorm.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.InnerBatchNorm.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/inner.html#InnerBatchNorm.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InnerBatchNorm.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.BatchNorm2d.html#torch.nn.BatchNorm2d" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.BatchNorm2d</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="normbatchnorm">
<h3><a class="toc-backref" href="#contents">NormBatchNorm</a><a class="headerlink" href="#normbatchnorm" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.NormBatchNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NormBatchNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/norm.html#NormBatchNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.NormBatchNorm" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Batch normalization for isometric (i.e. which preserves the norm) non-trivial representations.</p>
<p>The module assumes the mean of the vectors is always zero so no running mean is computed and no bias is added.
This is guaranteed as long as the representations do not include a trivial representation.</p>
<p>Indeed, if <span class="math notranslate nohighlight">\(\rho\)</span> does not include a trivial representation, it holds:</p>
<div class="math notranslate nohighlight">
\[\forall \bold{v} \in \mathbb{R}^n, \ \ \frac{1}{|G|} \sum_{g \in G} \rho(g) \bold{v} = \bold{0}\]</div>
<p>Hence, only the standard deviation is normalized.</p>
<p>Only representations which do not contain the trivial representation are allowed.
You can check if a representation contains the trivial representation using
<a class="reference internal" href="escnn.group.html#escnn.group.Representation.contains_trivial" title="escnn.group.Representation.contains_trivial"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contains_trivial()</span></code></a>.
To check if a trivial irrep is present in a representation in a <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a>, you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">field_type</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">contains_trivial</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;field type contains a trivial irrep&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – a value added to the denominator for numerical stability. Default: <code class="docutils literal notranslate"><span class="pre">1e-5</span></code></p></li>
<li><p><strong>momentum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – the value used for the <code class="docutils literal notranslate"><span class="pre">running_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">running_var</span></code> computation.
Can be set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for cumulative moving average (i.e. simple average). Default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></li>
<li><p><strong>affine</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, this module has learnable scale parameters. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.NormBatchNorm.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/norm.html#NormBatchNorm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.NormBatchNorm.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply norm non-linearities to the input feature map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="inducednormbatchnorm">
<h3><a class="toc-backref" href="#contents">InducedNormBatchNorm</a><a class="headerlink" href="#inducednormbatchnorm" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.InducedNormBatchNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InducedNormBatchNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/induced_norm.html#InducedNormBatchNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InducedNormBatchNorm" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Batch normalization for induced isometric representations.
This module requires the input fields to be associated to an induced representation from an isometric
(i.e. which preserves the norm) non-trivial representation which supports ‘norm’ non-linearities.</p>
<p>The module assumes the mean of the vectors is always zero so no running mean is computed and no bias is added.
This is guaranteed as long as the representations do not include a trivial representation.</p>
<p>Indeed, if <span class="math notranslate nohighlight">\(\rho\)</span> does not include a trivial representation, it holds:</p>
<div class="math notranslate nohighlight">
\[\forall \bold{v} \in \mathbb{R}^n, \ \ \frac{1}{|G|} \sum_{g \in G} \rho(g) \bold{v} = \bold{0}\]</div>
<p>Hence, only the standard deviation is normalized.
The same standard deviation, however, is shared by all the sub-fields of the same induced field.</p>
<p>The input representation of the fields is preserved by this operation.</p>
<p>Only representations which do not contain the trivial representation are allowed.
You can check if a representation contains the trivial representation using
<a class="reference internal" href="escnn.group.html#escnn.group.Representation.contains_trivial" title="escnn.group.Representation.contains_trivial"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contains_trivial()</span></code></a>.
To check if a trivial irrep is present in a representation in a <a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldType</span></code></a>, you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">field_type</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">contains_trivial</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;field type contains a trivial irrep&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – a value added to the denominator for numerical stability. Default: <code class="docutils literal notranslate"><span class="pre">1e-5</span></code></p></li>
<li><p><strong>momentum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – the value used for the <code class="docutils literal notranslate"><span class="pre">running_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">running_var</span></code> computation.
Can be set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for cumulative moving average (i.e. simple average). Default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></li>
<li><p><strong>affine</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, this module has learnable scale parameters. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.InducedNormBatchNorm.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/induced_norm.html#InducedNormBatchNorm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.InducedNormBatchNorm.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply norm non-linearities to the input feature map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="gnormbatchnorm">
<h3><a class="toc-backref" href="#contents">GNormBatchNorm</a><a class="headerlink" href="#gnormbatchnorm" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.GNormBatchNorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GNormBatchNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/gnorm.html#GNormBatchNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GNormBatchNorm" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Batch normalization for generic representations.</p>
<div class="admonition-todo admonition" id="id12">
<p class="admonition-title">Todo</p>
<p>Add more details about how stats are computed and how affine transformation is done.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – a value added to the denominator for numerical stability. Default: <code class="docutils literal notranslate"><span class="pre">1e-5</span></code></p></li>
<li><p><strong>momentum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – the value used for the <code class="docutils literal notranslate"><span class="pre">running_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">running_var</span></code> computation.
Can be set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for cumulative moving average (i.e. simple average). Default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></li>
<li><p><strong>affine</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, this module has learnable affine parameters. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.GNormBatchNorm.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/batchnormalization/gnorm.html#GNormBatchNorm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.GNormBatchNorm.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply norm non-linearities to the input feature map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="dropout">
<h2><a class="toc-backref" href="#contents">Dropout</a><a class="headerlink" href="#dropout" title="Permalink to this headline"></a></h2>
<section id="fielddropout">
<h3><a class="toc-backref" href="#contents">FieldDropout</a><a class="headerlink" href="#fielddropout" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.FieldDropout">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FieldDropout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/dropout/field.html#FieldDropout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldDropout" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Applies dropout to individual <em>fields</em> independently.</p>
<p>Notice that, with respect to <a class="reference internal" href="#escnn.nn.PointwiseDropout" title="escnn.nn.PointwiseDropout"><code class="xref py py-class docutils literal notranslate"><span class="pre">PointwiseDropout</span></code></a>, this module acts on a whole field instead
of single channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – dropout probability</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – can optionally do the operation in-place. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.FieldDropout.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/dropout/field.html#FieldDropout.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.FieldDropout.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="pointwisedropout">
<h3><a class="toc-backref" href="#contents">PointwiseDropout</a><a class="headerlink" href="#pointwisedropout" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.PointwiseDropout">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointwiseDropout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/dropout/pointwise.html#PointwiseDropout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseDropout" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Applies dropout to individual <em>channels</em> independently.</p>
<p>This class is just a wrapper for <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.functional.dropout.html#torch.nn.functional.dropout" title="(in PyTorch v1.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.functional.dropout()</span></code></a> in an <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a>.</p>
<p>Only representations supporting pointwise non-linearities are accepted as input field type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – dropout probability</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – can optionally do the operation in-place. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseDropout.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/dropout/pointwise.html#PointwiseDropout.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseDropout.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the resulting feature map</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.PointwiseDropout.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/dropout/pointwise.html#PointwiseDropout.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.PointwiseDropout.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Dropout.html#torch.nn.Dropout" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Dropout</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="other-modules">
<h2><a class="toc-backref" href="#contents">Other Modules</a><a class="headerlink" href="#other-modules" title="Permalink to this headline"></a></h2>
<section id="sequential">
<h3><a class="toc-backref" href="#contents">Sequential</a><a class="headerlink" href="#sequential" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.SequentialModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SequentialModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/sequential_module.html#SequentialModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.SequentialModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>A sequential container similar to <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Sequential.html#torch.nn.Sequential" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Sequential</span></code></a>.</p>
<p>The constructor accepts both a list or an ordered dict of <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> instances.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of SequentialModule</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">gspaces</span><span class="o">.</span><span class="n">rot2dOnR2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">trivial_repr</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c_out</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">regular_repr</span><span class="p">]</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">SequentialModule</span><span class="p">(</span>
          <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">R2Conv</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
          <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">InnerBatchNorm</span><span class="p">(</span><span class="n">c_out</span><span class="p">),</span>
          <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="n">c_out</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Example with OrderedDict</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">gspaces</span><span class="o">.</span><span class="n">rot2dOnR2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">trivial_repr</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c_out</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FieldType</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">regular_repr</span><span class="p">]</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">SequentialModule</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">([</span>
          <span class="p">(</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">R2Conv</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
          <span class="p">(</span><span class="s1">&#39;bn&#39;</span><span class="p">,</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">InnerBatchNorm</span><span class="p">(</span><span class="n">c_out</span><span class="p">)),</span>
          <span class="p">(</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">escnn</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="n">c_out</span><span class="p">)),</span>
<span class="p">]))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.SequentialModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/sequential_module.html#SequentialModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.SequentialModule.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input GeometricTensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the output tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.SequentialModule.add_module">
<span class="sig-name descname"><span class="pre">add_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/sequential_module.html#SequentialModule.add_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.SequentialModule.add_module" title="Permalink to this definition"></a></dt>
<dd><p>Append <code class="docutils literal notranslate"><span class="pre">module</span></code> to the sequence of modules applied in the forward pass.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.SequentialModule.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/sequential_module.html#SequentialModule.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.SequentialModule.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Sequential.html#torch.nn.Sequential" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Sequential</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="restriction">
<h3><a class="toc-backref" href="#contents">Restriction</a><a class="headerlink" href="#restriction" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.RestrictionModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RestrictionModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/restriction_module.html#RestrictionModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.RestrictionModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Restricts the type of the input to the subgroup identified by <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
<p>It computes the output type in the constructor and wraps the underlying tensor (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) in input
with the output type during the forward pass.</p>
<p>This module only acts as a wrapper for <a class="reference internal" href="#escnn.nn.FieldType.restrict" title="escnn.nn.FieldType.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.FieldType.restrict()</span></code></a>
(or <a class="reference internal" href="#escnn.nn.GeometricTensor.restrict" title="escnn.nn.GeometricTensor.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.GeometricTensor.restrict()</span></code></a>).
The accepted values of <code class="docutils literal notranslate"><span class="pre">id</span></code> depend on the underlying <code class="docutils literal notranslate"><span class="pre">gspace</span></code> in the input type <code class="docutils literal notranslate"><span class="pre">in_type</span></code>; check the
documentation of the method <a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace.restrict" title="escnn.gspaces.GSpace.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.gspaces.GSpace.restrict()</span></code></a> of the gspace used for
further information.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#escnn.nn.FieldType.restrict" title="escnn.nn.FieldType.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.FieldType.restrict()</span></code></a>,
<a class="reference internal" href="#escnn.nn.GeometricTensor.restrict" title="escnn.nn.GeometricTensor.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.GeometricTensor.restrict()</span></code></a>,
<a class="reference internal" href="escnn.gspaces.html#escnn.gspaces.GSpace.restrict" title="escnn.gspaces.GSpace.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.gspaces.GSpace.restrict()</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>id</strong> – a valid id for a subgroup of the space associated with the input type</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.RestrictionModule.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/restriction_module.html#RestrictionModule.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.RestrictionModule.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Identity.html#torch.nn.Identity" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Identity</span></code></a> module and set to “eval” mode.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only working with PyTorch &gt;= 1.2</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="disentangle">
<h3><a class="toc-backref" href="#contents">Disentangle</a><a class="headerlink" href="#disentangle" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.DisentangleModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DisentangleModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/disentangle_module.html#DisentangleModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.DisentangleModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Disentangles the representations in the field type of the input.</p>
<p>This module only acts as a wrapper for <a class="reference internal" href="escnn.group.html#escnn.group.disentangle" title="escnn.group.disentangle"><code class="xref py py-func docutils literal notranslate"><span class="pre">escnn.group.disentangle()</span></code></a>.
In the constructor, it disentangles each representation in the input type to build the output type and
pre-compute the change of basis matrices needed to transform each input field.</p>
<p>During the forward pass, each field in the input tensor is transformed with the change of basis corresponding
to its representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="upsampling">
<h3><a class="toc-backref" href="#contents">Upsampling</a><a class="headerlink" href="#upsampling" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.R2Upsampling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R2Upsampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/r2upsampling.html#R2Upsampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R2Upsampling" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Wrapper for <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.functional.interpolate.html#torch.nn.functional.interpolate" title="(in PyTorch v1.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.functional.interpolate()</span></code></a>. Check its documentation for further details.</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code> methods are supported.
However, <code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code> is not equivariant; using this method may result in broken equivariance.
For this reason, we suggest to use <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code> (default value).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even if the input tensor has a <cite>coords</cite> attribute, the output of this module will not have one.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – multiplier for spatial size</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – algorithm used for upsampling: <code class="docutils literal notranslate"><span class="pre">nearest</span></code> | <code class="docutils literal notranslate"><span class="pre">bilinear</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">bilinear</span></code></p></li>
<li><p><strong>align_corners</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the corner pixels of the input and output tensors are aligned, and thus
preserving the values at those pixels. This only has effect when mode is <code class="docutils literal notranslate"><span class="pre">bilinear</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.R2Upsampling.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/r2upsampling.html#R2Upsampling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R2Upsampling.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – input feature map</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the result of the convolution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.R2Upsampling.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/r2upsampling.html#R2Upsampling.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.R2Upsampling.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Upsample.html#torch.nn.Upsample" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Upsample</span></code></a> module and set to “eval” mode.</p>
</dd></dl>

</dd></dl>

</section>
<section id="multiple">
<h3><a class="toc-backref" href="#contents">Multiple</a><a class="headerlink" href="#multiple" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.MultipleModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MultipleModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reshuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/multiple_module.html#MultipleModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.MultipleModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Split the input tensor in multiple branches identified by the input <code class="docutils literal notranslate"><span class="pre">labels</span></code> and apply to each of them the
corresponding module in <code class="docutils literal notranslate"><span class="pre">modules</span></code></p>
<p>A label is associated to each field in the input type, while <code class="docutils literal notranslate"><span class="pre">modules</span></code> assigns a module to apply to
each label (or set of labels).
<code class="docutils literal notranslate"><span class="pre">modules</span></code> should be a list of pairs, each containing an <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquivariantModule</span></code></a> and a label (or a
list of labels).</p>
<p>During forward, fields are grouped by the labels and the input tensor is split accordingly.
Then, each subtensor is passed to the corresponding module in <code class="docutils literal notranslate"><span class="pre">modules</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">reshuffle</span></code> is set to a positive integer, a copy of the input tensor is first built sorting the
fields according to the value set:</p>
<ul class="simple">
<li><p>1: fields are sorted by their labels</p></li>
<li><p>2: fields are sorted by their labels and, then, by their size</p></li>
<li><p>3: fields are sorted by their labels, by their size and, then, by their type</p></li>
</ul>
<p>In this way, fields that need to be retrieved together are contiguous and it is possible to exploit slicing
to split the tensor.
By default, <code class="docutils literal notranslate"><span class="pre">reshuffle</span> <span class="pre">=</span> <span class="pre">0</span></code> which means that no sorting is performed and, so, if input
fields are not contiguous this layer will use indexing to retrieve sub-tensors.</p>
<p>This modules wraps a <code class="xref py py-class docutils literal notranslate"><span class="pre">BranchingModule</span></code> followed by a <code class="xref py py-class docutils literal notranslate"><span class="pre">MergeModule</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – the input field type</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – the list of labels to group the fields</p></li>
<li><p><strong>modules</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of modules to apply to the labeled fields</p></li>
<li><p><strong>reshuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – set how to reshuffle the input fields before splitting the tensor.
By default (<code class="docutils literal notranslate"><span class="pre">0</span></code>) no reshuffling is done</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.MultipleModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/multiple_module.html#MultipleModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.MultipleModule.forward" title="Permalink to this definition"></a></dt>
<dd><p>Split the input tensor according to the labels, apply each module to the corresponding input sub-tensors and
stack the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input GeometricTensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the concatenation of the output of each module</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="reshuffle">
<h3><a class="toc-backref" href="#contents">Reshuffle</a><a class="headerlink" href="#reshuffle" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.ReshuffleModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ReshuffleModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permutation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/reshuffle_module.html#ReshuffleModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.ReshuffleModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Permutes the fields of the input tensor according to the input <code class="docutils literal notranslate"><span class="pre">permutation</span></code>.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">permutation</span></code> should be a list containing a permutation of the integers <code class="docutils literal notranslate"><span class="pre">{0,</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">n-1}</span></code>,
where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of fields of <code class="docutils literal notranslate"><span class="pre">in_type</span></code> (see <a class="reference internal" href="#escnn.nn.FieldType.__len__" title="escnn.nn.FieldType.__len__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">escnn.nn.FieldType.__len__()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – input field type</p></li>
<li><p><strong>permutation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – permutation to apply</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="mask">
<h3><a class="toc-backref" href="#contents">Mask</a><a class="headerlink" href="#mask" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.MaskModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaskModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/masking_module.html#MaskModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.MaskModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Performs an element-wise multiplication of the input with a <em>mask</em> of shape <code class="docutils literal notranslate"><span class="pre">S</span> <span class="pre">x</span> <span class="pre">S</span></code>.</p>
<p>The mask has value <span class="math notranslate nohighlight">\(1\)</span> in all pixels with distance smaller than <code class="docutils literal notranslate"><span class="pre">(S-1)/2</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">margin)/100</span></code> from the
center of the mask and <span class="math notranslate nohighlight">\(0\)</span> elsewhere. Values change smoothly between the two regions.</p>
<p>This operation is useful to remove from an input image or feature map all the part of the signal defined on the
pixels which lay outside the circle inscribed in the grid.
Because a rotation would move these pixels outside the grid, this information would anyways be
discarded when rotating an image. However, allowing a model to use this information might break the guaranteed
equivariance as rotated and non-rotated inputs have different information content.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to perform the masking, the module expects an input with the same spatial dimensions as the mask.
Then, input tensors must have shape <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">x</span> <span class="pre">C</span> <span class="pre">x</span> <span class="pre">S</span> <span class="pre">x</span> <span class="pre">S</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – input field type</p></li>
<li><p><strong>S</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the shape of the mask and the expected inputs</p></li>
<li><p><strong>margin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – margin around the mask in percentage with respect to the radius of the mask
(default <code class="docutils literal notranslate"><span class="pre">0.</span></code>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="identity">
<h3><a class="toc-backref" href="#contents">Identity</a><a class="headerlink" href="#identity" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="escnn.nn.IdentityModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IdentityModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/identity_module.html#IdentityModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.IdentityModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#escnn.nn.EquivariantModule" title="escnn.nn.modules.equivariant_module.EquivariantModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">escnn.nn.modules.equivariant_module.EquivariantModule</span></code></a></p>
<p>Simple module which does not perform any operation on the input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>in_type</strong> (<a class="reference internal" href="#escnn.nn.FieldType" title="escnn.nn.FieldType"><em>FieldType</em></a>) – input (and output) type of this module</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.IdentityModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/identity_module.html#IdentityModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.IdentityModule.forward" title="Permalink to this definition"></a></dt>
<dd><p>Returns the input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<a class="reference internal" href="#escnn.nn.GeometricTensor" title="escnn.nn.GeometricTensor"><em>GeometricTensor</em></a>) – the input GeometricTensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the output tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="escnn.nn.IdentityModule.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/modules/identity_module.html#IdentityModule.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.IdentityModule.export" title="Permalink to this definition"></a></dt>
<dd><p>Export this module to a normal PyTorch <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Identity.html#torch.nn.Identity" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Identity</span></code></a> module and set to “eval” mode.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only working with PyTorch &gt;= 1.2</p>
</div>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-escnn.nn.init">
<span id="weight-initialization"></span><h2><a class="toc-backref" href="#contents">Weight Initialization</a><a class="headerlink" href="#module-escnn.nn.init" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="escnn.nn.init.generalized_he_init">
<span class="sig-name descname"><span class="pre">generalized_he_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basismanager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/init.html#generalized_he_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.init.generalized_he_init" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the weights of a convolutional layer with a generalized He’s weight initialization method.</p>
<p>Because the computation of the variances can be expensive, to save time on consecutive runs of the same model,
it is possible to cache the tensor containing the variance of each weight, for a specific <code class="docutils literal notranslate"><span class="pre">`basismanager`</span></code>.
This can be useful if a network contains multiple convolution layers of the same kind (same input and output types,
same kernel size, etc.) or if one needs to train the same network from scratch multiple times (e.g. hyper-parameter
search over learning rate).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The variance tensor is cached in memory and therefore is only available to the current process.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the tensor containing the weights</p></li>
<li><p><strong>basismanager</strong> (<a class="reference internal" href="#escnn.nn.modules.basismanager.BasisManager" title="escnn.nn.modules.basismanager.BasisManager"><em>BasisManager</em></a>) – the basis expansion method</p></li>
<li><p><strong>cache</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – cache the variance tensor. By default, <code class="docutils literal notranslate"><span class="pre">`cache=False`</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="escnn.nn.init.deltaorthonormal_init">
<span class="sig-name descname"><span class="pre">deltaorthonormal_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basismanager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/escnn/nn/init.html#deltaorthonormal_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#escnn.nn.init.deltaorthonormal_init" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the weights of a convolutional layer with <em>delta-orthogonal</em> initialization.</p>
<p>If no ‘radius’ attribute is present in the <cite>basismanager.get_basis_info()</cite>, it is assumed the parameters
parametrize a <a class="reference internal" href="#escnn.nn.Linear" title="escnn.nn.Linear"><code class="xref py py-class docutils literal notranslate"><span class="pre">Linear</span></code></a> layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><em>torch.Tensor</em></a>) – the tensor containing the weights</p></li>
<li><p><strong>basismanager</strong> (<a class="reference internal" href="#escnn.nn.modules.basismanager.BasisManager" title="escnn.nn.modules.basismanager.BasisManager"><em>BasisManager</em></a>) – the basis expansion method</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="escnn.gspaces.html" class="btn btn-neutral float-left" title="escnn.gspaces" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="escnn.nn.others.html" class="btn btn-neutral float-right" title="Other modules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Qualcomm Innovation Center, Inc. Developed by Gabriele Cesa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>